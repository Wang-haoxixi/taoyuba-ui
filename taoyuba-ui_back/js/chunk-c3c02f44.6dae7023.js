(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c3c02f44"],{"2f9e":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r("ac6a"),r("28a5"),r("a481");var n=r("b5c6");function a(e){var t=e.url,r=e.method,a=void 0===r?"post":r,i=e.data,s=void 0===i?{}:i,c=e.title,u=void 0===c?"":c;return new Promise((function(e){return Object(n["a"])({url:t,method:a,headers:{responseType:"arraybuffer"},data:s,responseType:"blob"}).then((function(t){o({title:u,response:t}).then((function(){e()}))}))}))}function o(e){var t=e.title,r=void 0===t?"":t,n=e.response,a=i(n.headers["content-disposition"].replace(/"/g,""));return new Promise((function(e){var t=n.headers,o=new Blob([n.data],{type:t["content-type"]});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,r);else{var i=document.createElement("a");i.href=window.URL.createObjectURL(o),i.download=r?"".concat(r,".").concat(a.suffix):a.filename,document.body.appendChild(i),i.style.display="none",i.click()}e()}))}function i(e){var t={},r=e.split(";");return r.forEach((function(e){var r=e.replace(/^\s+|\s+$/g,""),n=r.split("=");n[1]?t[n[0]]=n[1]:t[n[0]]=n[0]})),t.suffix=t.filename.split(".")[1],t}},3490:function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return s})),r.d(t,"h",(function(){return c})),r.d(t,"i",(function(){return u})),r.d(t,"a",(function(){return l})),r.d(t,"f",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"g",(function(){return d}));r("28a5");var n=r("b5c6"),a="/tmlms/relationship";function o(e){return Object(n["a"])({url:"".concat(a,"/getPage"),method:"get",params:e})}function i(e){return Object(n["a"])({url:"".concat(a,"/countRecord"),method:"get",params:e})}function s(e){return Object(n["a"])({url:"".concat(a,"/").concat(e),method:"get"})}function c(e){return Object(n["a"])({url:"".concat(a,"/remove"),method:"post",params:e})}function u(e){return Object(n["a"])({url:"".concat(a,"/edit"),method:"post",data:e})}function l(e){return Object(n["a"])({url:"".concat(a,"/create"),method:"post",data:e})}function p(e){return Object(n["a"])({url:"".concat(a,"/getLast"),method:"get",params:e})}function m(e){return new Promise((function(t,r){Object(n["a"])({url:"",method:"post",data:e,responseType:"arraybuffer"}).then((function(e){var r=e.headers["content-disposition"].split(";")[1];r=decodeURIComponent(r.split("=")[1]);var n=new Blob([e.data]),a=document.createElement("a");a.href=window.URL.createObjectURL(n),a.download=r,document.body.appendChild(a),a.style.display="none",a.click(),t()})).catch((function(){r()}))}))}function d(e){return Object(n["a"])({url:"/tmlms/statistic/relationRecordWithDays",method:"get",params:e})}},"84df":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("c1df"),a=r.n(n),o=function(){return a()().format("YYYY-MM-DD HH:mm:ss")}},ade36:function(e,t,r){"use strict";r.d(t,"w",(function(){return i})),r.d(t,"e",(function(){return s})),r.d(t,"r",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"t",(function(){return l})),r.d(t,"v",(function(){return p})),r.d(t,"h",(function(){return m})),r.d(t,"J",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"s",(function(){return h})),r.d(t,"x",(function(){return b})),r.d(t,"y",(function(){return g})),r.d(t,"o",(function(){return y})),r.d(t,"u",(function(){return v})),r.d(t,"z",(function(){return w})),r.d(t,"k",(function(){return O})),r.d(t,"m",(function(){return j})),r.d(t,"l",(function(){return N})),r.d(t,"n",(function(){return x})),r.d(t,"j",(function(){return T})),r.d(t,"G",(function(){return P})),r.d(t,"H",(function(){return R})),r.d(t,"b",(function(){return k})),r.d(t,"D",(function(){return I})),r.d(t,"I",(function(){return S})),r.d(t,"C",(function(){return E})),r.d(t,"q",(function(){return B})),r.d(t,"A",(function(){return D})),r.d(t,"c",(function(){return _})),r.d(t,"B",(function(){return C})),r.d(t,"f",(function(){return $})),r.d(t,"g",(function(){return L})),r.d(t,"E",(function(){return M})),r.d(t,"a",(function(){return U})),r.d(t,"K",(function(){return q})),r.d(t,"p",(function(){return H})),r.d(t,"F",(function(){return V}));var n=r("b5c6"),a=r("2f9e"),o="/tybship/tybship";function i(e){return Object(n["a"])({url:"".concat(o,"/otherpage"),method:"get",params:e})}function s(e,t){return Object(n["a"])({url:"".concat(o,"/updateVillage?shipId=").concat(e,"&&villageId=").concat(t),method:"post"})}function c(){return Object(n["a"])({url:"/admin/org/page",method:"get"})}function u(e,t){return Object(n["a"])({url:"".concat(o,"/updateOrgId?shipId=").concat(e,"&&orgId=").concat(t),method:"post"})}function l(e){return Object(n["a"])({url:"".concat(o,"/").concat(e),method:"get",params:e})}function p(e){return Object(n["a"])({url:"".concat(o,"/").concat(e),method:"get"})}function m(e){return Object(n["a"])({url:"".concat(o,"/save"),method:"post",data:e})}function d(e){return Object(n["a"])({url:"".concat(o,"/update"),method:"post",data:e})}function f(e){return Object(n["a"])({url:"".concat(o,"/del/").concat(e),method:"post"})}function h(e){return Object(n["a"])({url:"".concat(o,"/mypage"),method:"get",params:e})}function b(e){return Object(n["a"])({url:"".concat(o,"/findship/").concat(e),method:"get"})}function g(e){return Object(n["a"])({url:"".concat(o,"/findshipWithOutOrg/").concat(e),method:"get"})}function y(e){return Object(n["a"])({url:"/tmlms/tybship/findmyship/".concat(e),method:"get"})}function v(e){return Object(n["a"])({url:"".concat(o,"/searchByshipNo"),method:"get",params:{shipNo:e}})}function w(e){return Object(n["a"])({url:"".concat(o,"/newpageV2"),method:"get",params:e})}function O(e){return Object(a["a"])({url:"tybship/tybshipExcelExport/downShipInfo",data:e,title:"渔船信息"})}function j(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downShipCrew",data:e,title:"开航登记表-"+e.shipName})}function N(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downShipCrewRecord",data:e,title:"实名登记备案表-"+e.shipName})}function x(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downShipCrewTwoOld ",data:e,title:"船员登记表-"+e.shipName})}function T(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downContractModel",data:e,title:e.shipName})}function P(e){return Object(n["a"])({url:"tmlms/tyb_order/page",method:"get",params:e})}function R(e){return Object(n["a"])({url:"tmlms/tyb_order/getById",method:"get",params:e})}function k(e){return Object(n["a"])({url:"tmlms/tyb_order/agree",method:"post",data:e})}function I(e){return Object(n["a"])({url:"tmlms/tyb_order/reject",method:"post",data:e})}function S(e){return Object(n["a"])({url:"/tmlms/tybPortRecord/page",method:"get",params:e})}function E(e){return Object(n["a"])({url:"/tmlms/tybPortRecord/lastRecord",method:"get",params:e})}function B(e){return Object(n["a"])({url:"/tmlms/tybPortRecord/getCrewByRecordId",method:"get",params:e})}function D(e){return Object(n["a"])({url:"/tybship/tybship/info/".concat(e),method:"get"})}function _(e){return Object(n["a"])({url:"/tmlms/crew_cert/certStandard/".concat(e),method:"get"})}function C(e){return Object(n["a"])({url:"/tmlms/investigationReport/pageByShipName?shipName=".concat(e),method:"get"})}function $(e){return Object(n["a"])({url:"/tmlms/crew/countContractByShipId?shipId=".concat(e),method:"get"})}function L(e){return Object(n["a"])({url:"/tmlms/tybPortRecord/page",method:"get",params:e})}function M(e){return Object(n["a"])({url:"/tmlms/tybTroubleshootReport/pageByShipNo",method:"get",params:e})}function U(e){return Object(n["a"])({url:"/tmlms/tyb_order/pageByShipName",method:"get",params:e})}function q(e){return Object(n["a"])({url:"/tmlms/verification/page",method:"get",params:e})}function H(e){return console.log(e),Object(n["a"])({url:"/tmlms/tyb_order/getById?id=".concat(e.id),method:"get"})}function V(e){return Object(n["a"])({url:"/tmlms/tybmlmsExcelExport/downVerification",method:"post",headers:{"Content-Type":"application/json"},responseType:"arraybuffer",data:e}).then((function(e){var t=new Blob([e.data],{type:"application/vnd.ms-excel"}),r=document.createElement("a");r.href=window.URL.createObjectURL(t),r.download="实船鉴证.xls",r.click()}))}},cec6:function(e,t,r){"use strict";t["a"]={relationshipReason:[{label:"A",value:"1"},{label:"B",value:"2"}],relationshipType:[{label:"手机",value:1},{label:"座机",value:2},{label:"微信",value:3},{label:"其他",value:4}]}},e0ea:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"150px",disabled:"detail"===e.status}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"渔船名",prop:"shipName"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",remote:"",disabled:e.shipNameDisabled,maxlength:"20","remote-method":e.getShipNameList},on:{change:e.onChange},model:{value:e.form.shipName,callback:function(t){e.$set(e.form,"shipName",t)},expression:"form.shipName"}},e._l(e.shipNames,(function(e){return r("el-option",{key:e.shipId,attrs:{label:e.shipName,value:e.shipName}})})),1)],1)],1),r("el-col",{attrs:{span:e.span}},[r("el-form-item",{attrs:{label:"联系人",prop:"shipownerName"}},[r("el-input",{model:{value:e.form.shipownerName,callback:function(t){e.$set(e.form,"shipownerName","string"===typeof t?t.trim():t)},expression:"form.shipownerName"}})],1)],1),r("el-col",{attrs:{span:e.span}},[r("el-form-item",{attrs:{label:"手机号",prop:"shipownerPhone"}},[r("el-input",{attrs:{type:"number"},model:{value:e.form.shipownerPhone,callback:function(t){e.$set(e.form,"shipownerPhone","string"===typeof t?t.trim():t)},expression:"form.shipownerPhone"}})],1)],1),r("el-col",{attrs:{span:e.span}},[r("el-form-item",{attrs:{label:"联系设备",prop:"relationshipType"}},[r("el-select",{attrs:{placeholder:""},model:{value:e.form.relationshipType,callback:function(t){e.$set(e.form,"relationshipType",t)},expression:"form.relationshipType"}},e._l(e.map.relationshipType,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-col",{attrs:{span:e.span}},[3!==e.form.relationshipType?r("el-form-item",{attrs:{label:"联系号码",prop:"relationshipNumber"}},[r("el-input",{model:{value:e.form.relationshipNumber,callback:function(t){e.$set(e.form,"relationshipNumber","string"===typeof t?t.trim():t)},expression:"form.relationshipNumber"}})],1):e._e()],1),r("el-col",{attrs:{span:e.span}},[r("el-form-item",{attrs:{label:"联系事由",prop:"relationshipReason"}},[r("el-input",{attrs:{maxlength:"50"},model:{value:e.form.relationshipReason,callback:function(t){e.$set(e.form,"relationshipReason","string"===typeof t?t.trim():t)},expression:"form.relationshipReason"}})],1)],1),r("el-col",{attrs:{span:e.span}},[r("el-form-item",{attrs:{label:"联系时间",prop:"relationshipTime"}},[r("el-date-picker",{attrs:{"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"",align:"right"},model:{value:e.form.relationshipTime,callback:function(t){e.$set(e.form,"relationshipTime",t)},expression:"form.relationshipTime"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"附件"}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/admin/file/upload/avatar","on-success":e.handleSuccess,"on-remove":e.handleRemove,"before-upload":e.handleBeforeUpload,"file-list":e.fileList,"on-preview":e.handlePictureCardPreview,multiple:"",headers:e.headers,"list-type":"picture-card"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s("只能上传图片文件，且不超过4M"))])],1)],1)],1)],1),r("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":"",width:"820px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",{staticStyle:{"text-align":"center"}},[r("img",{staticStyle:{"max-width":"780px"},attrs:{src:e.dialogImageUrl,alt:""}})])])],1)},a=[],o=(r("8e6e"),r("456d"),r("96cf"),r("1da1")),i=(r("20d6"),r("ac6a"),r("ade3")),s=(r("c5f6"),r("3490")),c=r("ade36"),u=r("2f62"),l=r("0644"),p=r.n(l),m=r("cec6");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){Object(i["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={props:{status:String,value:{type:Object,default:function(){return{shipName:""}}},span:{type:Number,dafault:24},shipNameDisabled:{type:Boolean,dafault:!1}},data:function(){return{dialogImageUrl:"",dialogVisible:!1,map:m["a"],form:{shipownerName:"",shipownerPhone:"",relationshipType:"",files:[]},fileList:[],shipNames:[],rules:{shipName:[{required:!0,message:"请输入渔船名",trigger:["change","blur"]}],shipownerName:[{required:!0,message:"请输入联系人",trigger:"blur"}],shipownerPhone:[{required:!0,message:"请输入手机号",trigger:"blur"}],relationshipType:[{required:!0,message:"请选择联系设备",trigger:"change"}],relationshipNumber:[{required:!0,message:"请输入联系号码",trigger:"blur"}],relationshipReason:[{required:!0,message:"请选择联系事由",trigger:"blur"}],relationshipTime:[{required:!0,message:"请选择联系时间",trigger:"change"}]}}},computed:f(f({},Object(u["c"])(["dictGroup","access_token"])),{},{headers:function(){return{Authorization:"Bearer "+this.access_token}},pickerOptions:function(){var e=this;return{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}}],selectableRange:function(){var t=new Date,r=t.getHours(),n=t.getMinutes(),a=t.getSeconds();return e.form.relationshipTime&&t.getFullYear()==new Date(e.form.relationshipTime).getFullYear()&&t.getMonth()==new Date(e.form.relationshipTime).getMonth()&&t.getDate()==new Date(e.form.relationshipTime).getDate()?["00:00:00 - ".concat(r,":").concat(n,":").concat(a)]:["00:00:00 - 23:59:59"]}(),disabledDate:function(e){return e.getTime()>Date.now()}}}}),watch:{"form.relationshipType":{handler:function(e){this.getShipNameLastInfo(),3===e&&(this.form.relationshipNumber="")}},"form.shipName":{handler:function(){this.getShipNameLastInfo()}},value:{handler:function(e){this.form.shipName=e.shipName||"",this.form.shipownerName=e.shipownerName||"",this.form.shipownerPhone=e.shipownerPhone||"",this.getShipNameLastInfo()},deep:!0,immediate:!0}},methods:{handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSuccess:function(e,t,r){var n=p()(this.form.files);Array.isArray(this.form.files)||(this.form.files=[]),r.forEach((function(e){var t={name:"",url:e.response?e.response.data.url:""};""!==t.url&&-1===n.findIndex((function(e){return e.url===t.url}))&&n.push(t)})),this.form.files=n},handleRemove:function(e){var t=e.url,r=this.form.files.findIndex((function(e){return e.url===t}));r>-1&&this.form.files.splice(r,1)},handleBeforeUpload:function(e){var t=e.size/1024/1024<4;return t||this.$message.error("上传图片大小不能超过4MB"),t},getShipNameLastInfo:function(){var e=this;this.form.shipName&&this.form.relationshipType&&"detail"!==this.status&&Object(s["f"])({shipName:this.form.shipName,relationshipType:this.form.relationshipType}).then((function(t){var r=t.data;0===r.code&&r.data&&e.form.relationshipType===r.data.relationshipType&&e.$set(e.form,"relationshipNumber",r.data.relationshipNumber)}))},getShipNameList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(5!==t.length){e.next=12;break}return e.prev=1,e.next=4,Object(c["x"])(t);case 4:r=e.sent,n=r.data,0===n.code&&(this.shipNames=n.data),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$message({message:e.t0||"数据查询失败",type:"warning"});case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(t){return e.apply(this,arguments)}return t}(),onChange:function(e){var t=this.shipNames.filter((function(t){return t.shipName===e}));console.log("data",t,e),t&&t.length>0?(this.$set(this.form,"shipownerName",t[0].shipowner),this.$set(this.form,"shipownerPhone",t[0].mobile),console.log("this.form",this.form)):(this.form.shipownerName="",this.form.shipownerPhone="")},getList:function(e){var t=this;Object(s["e"])(e).then((function(e){var r=e.data;if(0===r.code){var n=r.data,a=[];null==n.relationshipImages&&(n.relationshipImages=[]),n.relationshipImages.forEach((function(e){var t={name:"",url:e};a.push(t)})),t.fileList=a,n.files=a,t.form=n,console.log("result",n)}}))},handleSubmit:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(t){var r="add"===e.status?s["a"]:"update"===e.status?s["i"]:null;r&&(e.form.relationshipImages=e.form.files.map((function(e){return e.url}))||[],r(e.form).then((function(t){var r=t.data;0===r.code&&(e.$notify({message:"add"===e.status?"新增成功":"编辑成功",type:"success"}),e.$emit("end"))})))}}))}}},b=h,g=r("2877"),y=Object(g["a"])(b,n,a,!1,null,"4a4601d7",null);t["default"]=y.exports}}]);