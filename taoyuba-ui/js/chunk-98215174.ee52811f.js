(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-98215174","chunk-2d0d7ac3","chunk-2d0d7ac3"],{"078a":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"new iep-page-form"},[a("basic-container",[a("page-header",{attrs:{title:"新建邮件",backOption:t.backOption}}),a("el-form",{ref:"form",staticClass:"form",attrs:{model:t.formData,rules:t.rules,size:"small","label-width":"100px"}},[a("el-form-item",{attrs:{label:"邮件类型："}},[a("el-radio-group",{model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},t._l(t.emailType,function(e,i){return a("el-radio-button",{key:i,attrs:{label:e.value}},[t._v(t._s(e.name))])}),1)],1),a("el-form-item",{staticClass:"validate",attrs:{label:"收件人：",prop:"receiverList"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n          收件人\n          "),a("iep-tip",{attrs:{content:t.tipContent.receiverList}}),t._v("：\n        ")],1),a("iep-contact-multiple",{model:{value:t.formData.receiverList,callback:function(e){t.$set(t.formData,"receiverList",e)},expression:"formData.receiverList"}})],1),a("el-form-item",{attrs:{label:"主题：",prop:"subject"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n          主题\n          "),a("iep-tip",{attrs:{content:t.tipContent.subject}}),t._v("：\n        ")],1),a("el-input",{attrs:{maxlength:50},model:{value:t.formData.subject,callback:function(e){t.$set(t.formData,"subject",e)},expression:"formData.subject"}})],1),a("el-form-item",{staticClass:"relation"},[a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"附件列表：","label-width":"90px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              附件列表\n              "),a("iep-tip",{attrs:{content:t.tipContent.attachmentList}})],1),a("iep-upload",{attrs:{limit:t.limit},model:{value:t.formData.attachmentList,callback:function(e){t.$set(t.formData,"attachmentList",e)},expression:"formData.attachmentList"}})],1)],1)]),a("el-form-item",[a("iep-button",{on:{click:t.addRelation}},[t._v("添加关联")])],1),a("el-form-item",{staticClass:"relation"},[a("div",{staticClass:"item"},[a("el-form-item",{attrs:{label:"关联资源：","label-width":"90px"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              关联资源\n              "),a("iep-tip",{attrs:{content:t.tipContent.transferList}})],1),this.formData.transferList.projectIds.length>0?a("ul",{staticClass:"list"},t._l(this.formData.transferList.projectIds,function(e,i){return a("li",{key:i,staticClass:"li"},[t._v(t._s(e.name)+" "),a("i",{staticClass:"el-icon-close",on:{click:function(e){return t.deleteRelatios("projectIds",i)}}})])}),0):t._e(),this.formData.transferList.materialIds.length>0?a("ul",{staticClass:"list"},t._l(this.formData.transferList.materialIds,function(e,i){return a("li",{key:i,staticClass:"li"},[t._v(t._s(e.name)+" "),a("i",{staticClass:"el-icon-close",on:{click:function(e){return t.deleteRelatios("materialIds",i)}}})])}),0):t._e()])],1)]),a("el-form-item",{attrs:{label:"邮件标签：",prop:"tagKeyWords"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n          邮件标签\n          "),a("iep-tip",{attrs:{content:t.tipContent.tagKeyWords}}),t._v("：\n        ")],1),a("iep-tag",{attrs:{plus:""},on:{selectTags:t.selectTags},model:{value:t.formData.tagKeyWords,callback:function(e){t.$set(t.formData,"tagKeyWords",e)},expression:"formData.tagKeyWords"}})],1),a("el-form-item",{attrs:{label:"正文",prop:"content"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n          正文\n          "),a("iep-tip",{attrs:{content:t.tipContent.content}}),t._v("：\n        ")],1),a("iep-froala-editor",{model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1),a("el-form-item",[a("operation-wrapper",[a("iep-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("发送")]),a("iep-button",{on:{click:function(e){return t.submitDraft("form")}}},[t._v("保存为草稿")]),a("iep-button",{on:{click:function(e){return t.resetForm("form")}}},[t._v("重置表单")])],1)],1)],1)],1),a("main-dialog",{ref:"relation",on:{relativeSubmit:t.relativeSubmit}})],1)},n=[],r=(a("6b54"),a("ac4d"),a("8a81"),a("ac6a"),a("42bf")),s=a("2762"),o=function(){return{attachmentIds:[],attachmentList:[],content:"",emailId:0,materialIds:[],projectIds:[],receiverIds:[],receiverList:{unions:[],orgs:[],users:[]},transferList:{projectIds:[],summaryIds:[],materialIds:[],reportIds:[]},reportIds:[],status:1,subject:"",summaryIds:[],tagKeyWords:[],type:0,kind:0}},c=function(t,e,a){0==e.orgs.length&&0==e.users.length?a(new Error):a()},l={content:[{required:!0,message:"必填",trigger:"blur"}],subject:[{required:!0,message:"必填",trigger:"blur"}],receiverList:[{validator:c,message:"必填",trigger:"change"}]},u={receiverList:"1、需要回复或采取行动的人<br/>2、需要了解此次邮件事项相关的人",subject:"1、部门简称+关于+事项+邮件类型，国脉集团研发中心关于内网2.0开发进度工作汇报",attachmentList:"1、附件文件应按照文件内容准确命名；<br/>2、附件控制在200M以下。",transferList:"1、准确关联资源<br/>2、资源材料应按照文件内容准确命名",tagKeyWords:"1、标签必须围绕邮件主题/内容，优先选择推荐标签；<br/>2、标签数量必须在3个以上。",content:"1、正文中要有称呼，发送对象只有一位，就根据该收件人职务称呼，如收件人为多位，称呼可用各位同事，各位领导+“：”；<br/>2、具体内容另起一行，并首行缩进2个字符；<br/>3、正文中除了“你好！”，“谢谢！”以外尽量不要使用“！”；<br/>4、字体格式：使用默认字体，字号，如复制有格式的文字请进行格式清除；<br/>请注意不要出现错别字！"},m={components:{MainDialog:r["default"]},data:function(){var t=this;return{formData:o(),tipContent:u,rules:l,pageState:"new",backOption:{isBack:!1,backPath:null,backFunction:function(){t.$emit("load-page",t.backType)}},limit:99,emailType:[{name:"普通",value:0},{name:"批示",value:1}],backType:"list"}},methods:{open:function(t){this.pageState="draft",this.backOption.isBack=!0,t.receiverIds=t.receivers.map(function(t){return t.receiverId}),t.receiverList={unions:[],orgs:[],users:this.dealWithList(t.receivers,[{O:"id",X:"receiverId"},{O:"name",X:"receiverRealName"}])},t.transferList={projectIds:this.dealWithList(t.projectRelatios,[{O:"id",X:"relatiionId"},{O:"name",X:"relatiionName"}]),summaryIds:[],materialIds:this.dealWithList(t.materialRelatios,[{O:"id",X:"relatiionId"},{O:"name",X:"relatiionName"}]),reportIds:[]},t.attachmentList=this.dealWithList(t.attachmentRelatios,[{O:"url",X:"attachmentUrl"},{O:"id",X:"relatiionId"},{O:"name",X:"relatiionName"}]),this.formData=t,this.relativeSubmit(t.transferList)},dealWithList:function(t,e){var a=[],i=!0,n=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value,l={},u=!0,m=!1,f=void 0;try{for(var d,h=e[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var p=d.value;l[p.O]=c[p.X]}}catch(v){m=!0,f=v}finally{try{u||null==h.return||h.return()}finally{if(m)throw f}}a.push(l)}}catch(v){n=!0,r=v}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}return a},resetForm:function(){this.$refs["form"].resetFields(),this.formData=o()},dealReceiverList:function(){this.relativeSubmit(this.formData.transferList),this.formData.receiverIds=this.formData.receiverList.users.map(function(t){return t.id}),this.formData.orgIds=this.formData.receiverList.orgs.map(function(t){return t.id}),this.formData.attachmentIds=this.formData.attachmentList.map(function(t){return t.id})},submitForm:function(t){var e=this;this.dealReceiverList(),this.$refs[t].validate(function(t){if(!t)return!1;e.formData.status=1;var a="draft"==e.pageState?s["n"]:s["a"];a(e.formData).then(function(){e.$message({message:"发送邮件成功",type:"success"}),e.formData=o(),"new"!==e.pageState?(console.log("new"),e.$emit("load-page","list")):(console.log("sent"),e.$router.push("/wel/mail/sent")),e.$route.query.back&&e.$router.push(e.$route.query.back)})})},submitDraft:function(){var t=this;this.dealReceiverList(),this.formData.status=0;var e="draft"==this.pageState?s["n"]:s["a"];e(this.formData).then(function(){t.$message({message:"保存草稿成功",type:"success"}),t.formData=o(),"new"!==t.pageState?t.$emit("load-page","list"):t.$router.push("/wel/mail/draft")}).catch(function(e){t.$message.error(e.toString())})},addRelation:function(){this.$refs["relation"].dialogShow=!0,this.$refs["relation"].loadData(this.formData.transferList)},selectTags:function(){},relativeSubmit:function(t){this.formData.materialIds=t.materialIds.map(function(t){return t.id}),this.formData.projectIds=t.projectIds.map(function(t){return t.id}),this.formData.transferList=t},deleteRelatios:function(t,e){this.formData.transferList[t].splice(e,1)}},created:function(){this.formData=o()}},f=m,d=(a("48c9"),a("e97f"),a("2877")),h=Object(d["a"])(f,i,n,!1,null,"4e207108",null);e["default"]=h.exports},"0814":function(t,e,a){},"0a22":function(t,e,a){"use strict";a.d(e,"f",function(){return s}),a.d(e,"e",function(){return o}),a.d(e,"a",function(){return c}),a.d(e,"g",function(){return l}),a.d(e,"d",function(){return u}),a.d(e,"b",function(){return m}),a.d(e,"c",function(){return f});var i=a("53ca"),n=a("b5c6"),r="/prms/iepProjectInformation";function s(t){return Object(n["a"])({url:"".concat(r,"/page"),method:"get",params:t})}function o(t){return Object(n["a"])({url:"".concat(r,"/page"),method:"get",params:t})}function c(t){return Object(n["a"])({url:"".concat(r),method:"post",data:t})}function l(t){return Object(n["a"])({url:"".concat(r,"/edit"),method:"post",data:t})}function u(t){return Object(n["a"])({url:"".concat(r,"/").concat(t),method:"get"})}function m(t){var e="object"===Object(i["a"])(t)?t:[t];return Object(n["a"])({url:"".concat(r,"/delete/batch"),method:"post",data:e})}function f(t){return Object(n["a"])({url:"".concat(r,"/projectApproval"),method:"get",params:t})}},"0c1c":function(t,e,a){"use strict";a("ac4d"),a("8a81"),a("ac6a");var i=a("2762");e["a"]={data:function(){return{pageState:"list",selectList:[]}},methods:{handleDetail:function(t){this.pageState="detail",this.$refs["mainDialog"].formData=t},backPage:function(t){this.pageState="list",t&&this.$refs["table"].loadPage({type:this.type})},multipleSelect:function(t,e){this.multipleSelection=t,this.selectList=e},allRead:function(){var t=this;Object(i["l"])(this.multipleSelection).then(function(){t.$message({message:"操作成功",type:"success"}),t.$refs["table"].loadPage({})})},allDelete:function(){var t=this;Object(i["c"])(this.multipleSelection).then(function(){t.$message({message:"操作成功",type:"success"}),t.$refs["table"].loadPage({})})},loadPage:function(t){"list"===t?(this.pageState="list",this.$refs["table"].loadPage({})):this.pageState="detail"},forward:function(){var t=this;1===this.selectList.length?(this.pageState="form",Object(i["h"])(this.selectList[0].emailId).then(function(e){var a=e.data;t.forwardFn(a.data,"list")})):this.$message.error("请选择且只能选择一条邮件进行转发！")},detailForward:function(t){this.pageState="form",this.forwardFn(t,"detail")},forwardFn:function(t,e){this.forwardShow=!1,this.$refs["updateDialog"].resetForm(),this.$refs["updateDialog"].pageState="forward",this.$refs["updateDialog"].backOption.isBack=!0,this.$refs["updateDialog"].backType=e,this.$refs["updateDialog"].formData.content=t.content,this.$refs["updateDialog"].formData.subject=t.subject,this.$refs["updateDialog"].formData.transferList={projectIds:this.dealWithTransferList(t.projectRelatios,[{O:"id",X:"relatiionId"},{O:"name",X:"relatiionName"}]),summaryIds:[],materialIds:this.dealWithTransferList(t.materialRelatios,[{O:"id",X:"relatiionId"},{O:"name",X:"relatiionName"}]),reportIds:[]},this.$refs["updateDialog"].formData.kind=2},detailReply:function(t){this.pageState="form",this.$refs["updateDialog"].resetForm(),this.$refs["updateDialog"].pageState="reply",this.$refs["updateDialog"].backOption.isBack=!0,this.$refs["updateDialog"].backType="detail",this.$refs["updateDialog"].formData.receiverList=t.receiverList,this.$refs["updateDialog"].formData.content=t.content,this.$refs["updateDialog"].formData.subject=t.subject,this.$refs["updateDialog"].formData.transferList={projectIds:this.dealWithTransferList(t.projectRelatios,[{O:"id",X:"relatiionId"},{O:"name",X:"relatiionName"}]),summaryIds:[],materialIds:this.dealWithTransferList(t.materialRelatios,[{O:"id",X:"relatiionId"},{O:"name",X:"relatiionName"}]),reportIds:[]},this.$refs["updateDialog"].formData.kind=1},dealWithTransferList:function(t,e){var a=[],i=!0,n=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value,l={},u=!0,m=!1,f=void 0;try{for(var d,h=e[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var p=d.value;l[p.O]=c[p.X]}}catch(v){m=!0,f=v}finally{try{u||null==h.return||h.return()}finally{if(m)throw f}}a.push(l)}}catch(v){n=!0,r=v}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}return a}}}},"0ec3":function(t,e,a){},"289f":function(t,e,a){"use strict";a.d(e,"a",function(){return i}),a.d(e,"d",function(){return n}),a.d(e,"c",function(){return r}),a.d(e,"b",function(){return s});var i={type:{1:"类型1",2:"类型2"}},n=[],r=[{label:"任务名称",prop:"name"},{label:"任务说明",prop:"shuoming"},{label:"进度",prop:"jindu"},{label:"负责人",prop:"fuzeren"},{label:"备注",prop:"beizhu"}],s=function(){return{content:"",attachmentRelatios:[],projectRelatios:[],materialRelatios:[],summaryRelatios:[]}}},3176:function(t,e,a){"use strict";a("4a65")},"42bf":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("iep-dialog",{attrs:{"dialog-show":t.dialogShow,title:"添加关联",width:"650px"},on:{close:t.resetForm}},[a("div",{staticClass:"iep-transfer"},[a("div",{staticClass:"head"},[a("div",{staticClass:"title"},[t._v("选择事项分类：")]),a("div",{staticClass:"radio"},t._l(t.selectList,function(e,i){return a("li",{key:i,class:t.activeIndex==i?"active":"",on:{click:function(a){return t.chosenIndex(e,i)}}},[t._v(t._s(e.name))])}),0)]),a("div",{staticClass:"content"},[a("div",{staticClass:"search"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入关键字"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.searchData},slot:"append"})],1)],1),a("div",{staticClass:"list"},[a("iep-scroll",{attrs:{load:t.projectState},on:{"load-page":t.loadProject}},[a("el-checkbox-group",{model:{value:t.formData,callback:function(e){t.formData=e},expression:"formData"}},t._l(t.relationlist,function(e,i){return a("div",{key:i,staticClass:"item"},[a("el-checkbox",{attrs:{label:e.id,name:"type"},on:{change:function(a){return t.changeItem(e)}}},[t._v(t._s(e.name))])],1)}),0)],1)],1)])]),a("template",{slot:"footer"},[a("iep-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("添加")]),a("iep-button",{on:{click:t.resetForm}},[t._v("取消")])],1)],2)},n=[],r=(a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("720d")),s=a("da8d"),o=a("0a22"),c={components:{IepScroll:r["default"]},data:function(){return{dialogShow:!1,activeIndex:0,projectState:0,selectList:[{name:"报表"},{name:"项目",requestFn:o["e"],type:"projectIds"},{name:"材料",requestFn:s["f"],type:"materialIds"},{name:"日报"}],transferList:{projectIds:[],summaryIds:[],materialIds:[],reportIds:[]},name:"",relationlist:[],params:{current:1,size:10,name:""},formData:[]}},methods:{loadData:function(t){this.transferList=t,this.chosenIndex(this.selectList[2],2)},resetForm:function(){this.dialogShow=!1},chosenIndex:function(t,e){if(t.type){this.formData=[];var a=!0,i=!1,n=void 0;try{for(var r,s=this.transferList[this.selectList[e].type][Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var o=r.value;this.formData.push(o.id)}}catch(c){i=!0,n=c}finally{try{a||null==s.return||s.return()}finally{if(i)throw n}}this.relationlist=[],this.params={current:1,size:10,name:""},this.activeIndex=e,this.getListFn()}else this.$message.info("抱歉，这块功能还未实现！")},searchData:function(){this.relationlist=[],this.projectState=4,this.params.current=1,this.params.name=this.name,this.getListFn()},getListFn:function(){var t=this,e=this.selectList[this.activeIndex];e.requestFn(this.params).then(function(a){var i=a.data;if(i.data.records.length>0){if(t.projectState=0,"项目"==e.name){var n=!0,r=!1,s=void 0;try{for(var o,c=i.data.records[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var l=o.value;l.name=l.projectName}}catch(u){r=!0,s=u}finally{try{n||null==c.return||c.return()}finally{if(r)throw s}}}t.relationlist=t.relationlist.concat(i.data.records)}else t.projectState=7})},submitForm:function(){this.dialogShow=!1,this.$emit("relativeSubmit",this.transferList)},loadProject:function(){this.projectState=4,++this.params.current,this.getListFn()},changeItem:function(t){var e=this.transferList[this.selectList[this.activeIndex].type];for(var a in e)if(e[a].id==t.id)return void this.transferList[this.selectList[this.activeIndex].type].splice(a,1);this.transferList[this.selectList[this.activeIndex].type].push(t)}}},l=c,u=(a("52e0"),a("2877")),m=Object(u["a"])(l,i,n,!1,null,"60e08a71",null);e["default"]=m.exports},"48c9":function(t,e,a){"use strict";a("f1fc")},"4a65":function(t,e,a){},"4ba2":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inbox"},[a("basic-container",[a("div",{staticClass:"head"},[a("page-header",{staticClass:"title",attrs:{title:t.formData.subject,backOption:t.backOption}},[a("div",{staticClass:"tags",attrs:{slot:"sub"},slot:"sub"},[a("iep-tag-detail",{model:{value:t.formData.tagKeyWords,callback:function(e){t.$set(t.formData,"tagKeyWords",e)},expression:"formData.tagKeyWords"}})],1)])],1),a("div",{staticClass:"info"},[a("div",{staticClass:"msg"},[t._v("发件人："+t._s(t.formData.sendRealName))]),a("div",{staticClass:"msg"},[t._v("收件人："),t._l(t.formData.receivers,function(e,i){return a("span",{key:i},[t._v(t._s(e.receiverRealName)+t._s(i==t.formData.receivers.length-1?"":"；"))])})],2),a("div",{staticClass:"msg"},[t._v("时"),a("span",{staticStyle:{width:"14px",display:"inline-block"}}),t._v("间："+t._s(t.formData.createTime))])]),a("div",{staticClass:"content"},[a("iep-html",{model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1),t.formData.attachmentRelatios.length?a("div",{staticClass:"appendix"},[a("h3",[t._v("附件")]),a("ul",{staticClass:"list"},t._l(t.formData.attachmentRelatios,function(e,i){return a("li",{key:i},[a("i",{staticClass:"icon-fujian"}),t._v(t._s(e.relatiionName)+" "),a("iep-button",{attrs:{type:"text"},on:{click:function(a){return t.downloadFile(e)}}},[t._v("下载")])],1)}),0),a("iep-button",{attrs:{type:"text"},on:{click:t.downloadFileAll}},[a("i",{staticClass:"icon-download1"}),t._v(" 全部下载")])],1):t._e(),t.formData.projectRelatios.length>0||t.formData.materialRelatios.length>0||t.formData.summaryRelatios.length>0?a("div",{staticClass:"relation"},[a("h3",[t._v("关联")]),t.formData.projectRelatios.length>0?a("div",{staticClass:"item"},[a("div",{staticClass:"title"},[t._v("关联项目：")]),a("div",[a("ul",{staticClass:"list"},t._l(t.formData.projectRelatios,function(e,i){return a("li",{key:i},[t._v(t._s(e.relatiionName))])}),0)])]):t._e(),t.formData.summaryRelatios.length>0?a("div",{staticClass:"item"},[a("div",{staticClass:"title"},[t._v("关联纪要：")]),a("div",[a("ul",{staticClass:"list"},t._l(t.formData.summaryRelatios,function(e,i){return a("li",{key:i,on:{click:function(a){return t.handleMaterialDetail(e,"summary")}}},[t._v(t._s(e.relatiionName))])}),0)])]):t._e(),t.formData.materialRelatios.length>0?a("div",{staticClass:"item"},[a("div",{staticClass:"title"},[t._v("关联材料：")]),a("div",[a("ul",{staticClass:"list"},t._l(t.formData.materialRelatios,function(e,i){return a("li",{key:i,on:{click:function(a){return t.handleMaterialDetail(e,"material")}}},[t._v(t._s(e.relatiionName))])}),0)])]):t._e()]):t._e(),a("div",{staticClass:"footer"},[a("operation-wrapper",[a("iep-button",{attrs:{type:"primary"},on:{click:t.back}},[t._v("返回")]),a("iep-button",{on:{click:t.reply}},[t._v("回复")]),a("iep-button",{on:{click:t.allReply}},[t._v("回复全部")]),a("iep-button",{on:{click:t.forward}},[t._v("转发")]),a("iep-button",{on:{click:t.handleDelete}},[t._v("删除")])],1)],1)])],1)},n=[],r=(a("ac4d"),a("8a81"),a("ac6a"),a("289f")),s=a("2762"),o=a("2934"),c={components:{},data:function(){var t=this;return{backOption:{isBack:!0,backPath:null,backFunction:function(){t.back()}},formData:Object(r["b"])(),reportTableOption:r["c"],tableData:[{name:"任务A",shuoming:"内网2.0前端页面制作",jindu:"60%",fuzeren:"张超",beizhu:"以人为本，数据赋能"}],deleteList:{inbox:{name:"收件箱",request:s["e"]},send:{name:"发送",request:s["b"]},star:{name:"星标",request:s["f"]}}}},props:{emailType:{type:String,default:"inbox"}},methods:{back:function(){var t=this.$route.params;t.id?this.$router.go(-1):this.$emit("backWeb",!0)},handleDelete:function(){var t=this;this.deleteList[this.emailType].request(this.formData.emailId).then(function(){t.$message({message:"删除成功",type:"success"}),t.$emit("backWeb",!0)})},forward:function(){this.$emit("forward",this.formData)},reply:function(){this.formData.receiverList={unions:[],orgs:[],users:[{id:this.formData.sendId,name:this.formData.sendRealName}]},this.$emit("reply",this.formData)},allReply:function(){var t={unions:[],orgs:[],users:[{id:this.formData.sendId,name:this.formData.sendRealName}]},e=!0,a=!1,i=void 0;try{for(var n,r=this.formData.receivers[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value;t.users.push({id:s.receiverId,name:s.receiverRealName})}}catch(o){a=!0,i=o}finally{try{e||null==r.return||r.return()}finally{if(a)throw i}}this.formData.receiverList=t,this.$emit("reply",this.formData)},downloadFile:function(t){console.log("obj: ",t),Object(o["a"])({url:t.attachmentUrl,name:t.relatiionName})},downloadFileAll:function(){var t=!0,e=!1,a=void 0;try{for(var i,n=this.formData.attachmentRelatios[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var r=i.value;this.downloadFile(r)}}catch(s){e=!0,a=s}finally{try{t||null==n.return||n.return()}finally{if(e)throw a}}},handleMaterialDetail:function(t,e){this.$emit("materialDetail",t,e)}},created:function(){var t=this,e=this.$route.params;e.id&&Object(s["h"])(e.id).then(function(e){var a=e.data;t.formData=a.data})},watch:{"$route.params.id":function(t){var e=this;Object(s["h"])(t).then(function(t){var a=t.data;e.formData=a.data})}}},l=c,u=(a("94f7"),a("2877")),m=Object(u["a"])(l,i,n,!1,null,"2b855e7f",null);e["default"]=m.exports},"4bcf":function(t,e,a){},"502e":function(t,e,a){"use strict";var i=a("be94"),n=(a("96cf"),a("1da1")),r=a("51f4"),s={delete:"删除",shelf:"上架",submit:"提交",cancel:"撤销"};e["a"]={data:function(){return{pagedTable:[],multipleSelection:[],isLoadTable:!0,pagination:this._pageOption(),pageOption:this._pageOption(),searchForm:{}}},methods:{_pageOption:function(){return Object(r["a"])()},searchPage:function(t){this.pageOption=this._pageOption(),this.searchForm=t,this.loadPage(t)},loadTable:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e,a){var n,r,s,o,c,l,u,m,f,d=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=d.length>2&&void 0!==d[2]?d[2]:function(t){return t},this.isLoadTable=!0,t.next=4,a(Object(i["a"])({},this.pageOption,e));case 4:return r=t.sent,s=r.data,o=s.data,c=o.records,l=o.size,u=o.total,m=o.current,f=u/l+1===m,f&&0!==u?this.searchPage({current:m-1,size:l,total:u}):this.pagination={current:m,size:l,total:u},this.pagedTable=c.map(n),this.isLoadTable=!1,t.abrupt("return",s.data);case 12:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}(),handleSizeChange:function(t){this.pageOption.size=t,this.loadPage()},handleCurrentChange:function(t){this.pageOption.current=t,this.loadPage()},_handleGlobalDeleteById:function(t,e){this._handleGlobalById(t,e,"delete")},_handleGlobalDeleteAll:function(t){this._handleGlobalAll(t,"delete")},_handleGlobalById:function(t,e){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"delete",n=s[i];this.$confirm("此操作将".concat(n,"该数据, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e(t).then(function(t){t.data.data?a.$message({type:"success",message:"".concat(n,"成功!")}):a.$message({type:"info",message:"".concat(n,"失败，").concat(t.data.msg)}),a.loadPage()})})},_handleGlobalAll:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,i,r,o=this,c=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(a=c.length>1&&void 0!==c[1]?c[1]:"delete",i=this.multipleSelection,r=s[a],void 0!==i&&0!==i.length){t.next=6;break}return this.$message("请先选择需要".concat(r,"的选项")),t.abrupt("return");case 6:this.$confirm("此操作将".concat(r,"这些数据, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark(function t(){var a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e(i);case 2:a=t.sent,n=a.data,n.data?(o.$message({type:"success",message:"".concat(r,"成功!")}),o.pageOption=o._pageOption()):o.$message({type:"info",message:"".concat(r,"失败，").concat(n.msg)}),o.loadPage();case 6:case"end":return t.stop()}},t)})));case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),_handleComfirm:function(t,e,a,i,r){var s=this;this.$confirm(i||"是否".concat(a),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark(function i(){var n,o;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e(t);case 2:n=i.sent,o=n.data,o.data?s.$message({type:"success",message:r||"".concat(a,"成功!")}):s.$message({type:"info",message:"".concat(o.msg)}),s.loadPage();case 6:case"end":return i.stop()}},i)}))).catch(function(t){s.$message({type:"info",message:"".concat(t,", 已取消").concat(a)})})},mixinsCellPointerStyle:function(t){var e=t.column;return"index"!==e.type&&"selection"!==e.type&&"操作"!==e.label&&"cursor:pointer"}}}},"52e0":function(t,e,a){"use strict";a("4bcf")},"5b3c":function(t,e,a){"use strict";a("0ec3")},"720d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"myScroll",staticClass:"iep-scroll",on:{"&scroll":function(e){return t.onScroll(e)}}},[t._t("default"),a("div",{staticClass:"footer"},[t._v(t._s(t.stateList[t.state]))])],2)},n=[],r=(a("c5f6"),{props:{loadData:{type:Function},load:{type:Number,default:0}},data:function(){return{myScroll:null,myScrollList:null,state:0,stateList:{0:"",1:"刷新中",2:"松开刷新",3:"刷新完成",4:"加载中",5:"加载完成",6:"下拉刷新",7:"暂无更多数据"}}},methods:{onScroll:function(t){var e=this.myScrollList.offsetHeight,a=t.target.scrollTop+this.myScroll.offsetHeight;0==this.state&&e-a<100&&this.bottomCallback()},bottomCallback:function(){7!=this.state&&(this.state=4,this.$emit("load-page",!0))}},watch:{load:function(t){this.state=t}},mounted:function(){this.myScroll=this.$refs.myScroll,this.myScrollList=this.myScroll.children[0]}}),s=r,o=(a("92aa"),a("2877")),c=Object(o["a"])(s,i,n,!1,null,null,null);e["default"]=c.exports},"788d":function(t,e,a){var i=a("5ca1"),n=a("6821"),r=a("9def");i(i.S,"String",{raw:function(t){var e=n(t.raw),a=r(e.length),i=arguments.length,s=[],o=0;while(a>o)s.push(String(e[o++])),o<i&&s.push(String(arguments[o]));return s.join("")}})},"92aa":function(t,e,a){"use strict";a("9b4b")},"94f7":function(t,e,a){"use strict";a("a9e4")},"9b4b":function(t,e,a){},a9e4:function(t,e,a){},ba13:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("basic-container",[a("main-form-dialog",{directives:[{name:"show",rawName:"v-show",value:"detail"==t.pageState,expression:"pageState=='detail'"}],ref:"mainDialog",on:{backPage:t.backPage,forward:t.detailForward,reply:t.detailReply,materialDetail:t.materialDetail}}),"summary"==t.pageState?a("summary-detail",{ref:"summary",attrs:{detailState:!0},on:{backPage:t.backPage}}):t._e(),"material"==t.pageState?a("material-detail",{ref:"material",attrs:{detailState:!0},on:{backPage:t.backPage}}):t._e(),a("update-form-dialog",{directives:[{name:"show",rawName:"v-show",value:"form"==t.pageState,expression:"pageState=='form'"}],ref:"updateDialog",on:{backWeb:t.backWeb,"load-page":t.loadPage}})],1)},n=[],r=a("502e"),s=a("0c1c"),o=a("4ba2"),c=a("0095"),l=a("e1ce"),u=a("078a"),m={name:"inbox",mixins:[r["a"],s["a"]],components:{SummaryDetail:c["default"],MaterialDetail:l["default"],mainFormDialog:o["default"],UpdateFormDialog:u["default"]},data:function(){return{pageState:"detail"}},methods:{backPage:function(){this.pageState="detail"},materialDetail:function(t,e){var a=this,i={summary:{name:"纪要",ref:"summary"},material:{name:"材料",ref:"material"}};this.pageState=i[e].ref,this.$nextTick(function(){a.$refs[i[e].ref].open(t.relatiionId)})},backWeb:function(){this.$router.go(-1)},loadPage:function(){this.pageState="detail"}}},f=m,d=(a("3176"),a("2877")),h=Object(d["a"])(f,i,n,!1,null,"49066fd2",null);e["default"]=h.exports},da6a:function(t,e,a){"use strict";a.d(e,"d",function(){return s}),a.d(e,"c",function(){return o}),a.d(e,"a",function(){return c}),a.d(e,"e",function(){return l}),a.d(e,"b",function(){return u});var i=a("53ca"),n=a("b5c6"),r="/mlms/materiallevel";function s(t){return Object(n["a"])({url:"".concat(r,"/page"),method:"get",params:t})}function o(){return Object(n["a"])({url:"".concat(r,"/tree"),method:"get"})}function c(t){return Object(n["a"])({url:"".concat(r,"/create"),method:"post",data:t})}function l(t){return Object(n["a"])({url:"".concat(r,"/update"),method:"post",data:t})}function u(t){var e="object"===Object(i["a"])(t)?t:[t];return Object(n["a"])({url:"".concat(r,"/delete/batch"),method:"post",data:e})}},da8d:function(t,e,a){"use strict";a.d(e,"h",function(){return s}),a.d(e,"f",function(){return o}),a.d(e,"i",function(){return c}),a.d(e,"a",function(){return l}),a.d(e,"l",function(){return u}),a.d(e,"b",function(){return m}),a.d(e,"d",function(){return f}),a.d(e,"c",function(){return d}),a.d(e,"e",function(){return h}),a.d(e,"g",function(){return p}),a.d(e,"j",function(){return v}),a.d(e,"k",function(){return g});var i=a("53ca"),n=a("b5c6"),r="/mlms/material";function s(t){return Object(n["a"])({url:"".concat(r,"/page"),method:"get",params:t})}function o(t){return Object(n["a"])({url:"".concat(r,"/page"),method:"get",params:t})}function c(t){return Object(n["a"])({url:"".concat(r,"/page/personal"),method:"get",params:t})}function l(t){return Object(n["a"])({url:"".concat(r,"/create"),method:"post",data:t})}function u(t){return Object(n["a"])({url:"".concat(r,"/update"),method:"post",data:t})}function m(t){var e="object"===Object(i["a"])(t)?t:[t];return Object(n["a"])({url:"".concat(r,"/delete/batch"),method:"post",data:e})}function f(t){return Object(n["a"])({url:"".concat(r,"/").concat(t),method:"get"})}function d(t){return Object(n["a"])({url:"".concat(r,"/getUpload/").concat(t),method:"get"})}function h(t){return Object(n["a"])({url:"".concat(r,"/excellent/list/").concat(t),method:"get"})}function p(t){return Object(n["a"])({url:"".concat(r,"/total/").concat(t),method:"get"})}function v(){return Object(n["a"])({url:"".concat(r,"/get/union"),method:"post"})}function g(t){return Object(n["a"])({url:"".concat(r,"/get/new/version"),method:"post",data:t})}},e1ce:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{oncontextmenu:"return "+(1!=t.formData.secrecyLevel),onselectstart:"return "+(1!=t.formData.secrecyLevel)}},[a("basic-container",[a("el-col",{staticClass:"left"},[a("page-header",{attrs:{title:t.formData.materialName,backOption:t.backOption}}),a("el-row",{staticClass:"info"},[a("div",{staticClass:"person"},[a("div",{staticClass:"name"},[t._v(t._s(t.formData.creatorRealName))]),a("div",{staticClass:"date"},[t._v(t._s(t.formData.createTime))]),a("div",[t._v(t._s(t.getClass(t.formData.firstClass,t.formData.secondClass).first)+" - "+t._s(t.getClass(t.formData.firstClass,t.formData.secondClass).second))])])]),a("el-row",{staticClass:"sub-title"},[a("pre",[t._v(t._s(t.formData.intro))])]),a("el-row",{staticClass:"content"},[a("iep-html",{model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1),a("el-row",{staticClass:"down-load"},[t._v("\n        相关附件：\n        "),t._l(t.formData.attachFileList,function(e,i){return a("div",{key:i,staticClass:"file"},[a("div",{on:{click:function(a){return t.downLoad(e)}}},[a("i",{staticClass:"icon-fujian"}),t._v(t._s(e.name)),a("span",{staticClass:"tip"},[t._v("（消耗"+t._s(t.getMoney(t.formData.downloadCost))+"下载）")])])])})],2),a("el-row",{staticClass:"footer"},[a("div",{staticClass:"footer-left"},[a("iep-tag-detail",{model:{value:t.formData.tagKeyWords,callback:function(e){t.$set(t.formData,"tagKeyWords",e)},expression:"formData.tagKeyWords"}})],1),t.isDelete?a("div",{staticClass:"footer-right"},[a("IepFiveKay",[1==t.formData.collection?a("IepKeyItem",{attrs:{icon:"icon-aixin",name:"已收藏",isChecked:""},nativeOn:{click:function(e){return t.handleCollect(e)}}}):a("IepKeyItem",{attrs:{icon:"icon-heart",name:"收藏"},nativeOn:{click:function(e){return t.handleCollect(e)}}}),a("IepKeyItem",{attrs:{icon:"icon-share",name:"分享"},nativeOn:{click:function(e){return t.handleShare(e)}}}),a("IepKeyItem",{attrs:{icon:"icon-chakantiezigengduojubao",name:"纠错"},nativeOn:{click:function(e){return t.handleWrong(e)}}}),a("IepKeyItem",{attrs:{icon:"icon-xiaoxi",name:"评论"},nativeOn:{click:function(e){return t.handleComment(e)}}}),a("IepKeyItem",{attrs:{icon:"icon-yuanbao",name:"打赏"},nativeOn:{click:function(e){return t.handleReward(e)}}})],1)],1):t._e()]),a("el-row",{staticClass:"comment"},[t.isCommentShow?a("div",{staticClass:"form"},[a("h2",{staticClass:"title"},[t._v("评价评论 "),a("div",{staticClass:"rate"},[a("el-rate",{model:{value:t.comment.score,callback:function(e){t.$set(t.comment,"score",e)},expression:"comment.score"}})],1)]),a("el-input",{attrs:{type:"textarea",rows:"5",maxlength:"500"},model:{value:t.comment.commentContent,callback:function(e){t.$set(t.comment,"commentContent",e)},expression:"comment.commentContent"}}),a("div",{staticClass:"button"},[a("iep-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("发送")])],1)],1):t._e(),t._l(t.commentList,function(e,i){return a("div",{key:i,staticClass:"list"},[a("div",{staticClass:"img"},[a("img",{attrs:{src:e.avatar,alt:""}})]),a("div",{staticClass:"comment-info"},[a("div",{staticClass:"name"},[t._v(t._s(e.realName)+" "),a("div",{staticClass:"rate"},[a("el-rate",{attrs:{disabled:""},model:{value:e.score,callback:function(a){t.$set(e,"score",a)},expression:"item.score"}})],1)]),a("p",[t._v(t._s(e.commentContent))]),a("div",{staticClass:"footer"},[a("div",{staticClass:"time"},[t._v(t._s(e.createTime))])])])])}),t.commentList.length>0?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:t.pageSize.total},on:{"current-change":t.handleCurrentChange}})],1):t._e()],2)],1),a("el-col",{staticClass:"right"},[a("div",{staticClass:"info"},[a("div",{staticClass:"name"},[t._v(t._s(t.formData.creatorRealName))]),a("div",{staticClass:"num"},[t._v("共"+t._s(t.materialTotal)+"篇材料")]),a("div",{staticClass:"foot"},[a("iep-button",{attrs:{type:"primary"},on:{click:t.subscribe}},[t._v("订阅")]),a("iep-button",{attrs:{type:"primary"},on:{click:t.apprentice}},[t._v("向他拜师")])],1)]),a("div",{staticClass:"material"},[a("h3",[t._v("优秀材料")]),t._l(t.greatMaterialList,function(e,i){return a("p",{key:i,on:{click:function(a){return t.handleDetail(e)}}},[t._v(t._s(e.name))])})],2)]),a("wrongDialog",{ref:"wrong"}),a("collection-dialog",{ref:"collection",attrs:{type:"material",requestFn:t.createCollect},on:{"load-page":t.loadPage}}),a("share-dialog",{ref:"share",attrs:{type:"material"}})],1)],1)},n=[],r=(a("ac4d"),a("8a81"),a("ac6a"),a("7f7f"),a("be94")),s=a("da8d"),o=a("9060"),c=a("2934"),l=a("d5c8"),u=a("6837"),m=a("38ef"),f=a("e44a"),d=a("2f62"),h=a("da6a");function p(){return{objectType:1,commentObjectId:0,commentContent:"",score:5}}var v={size:10,current:1,total:0},g={components:{wrongDialog:f["default"],CollectionDialog:l["default"],ShareDialog:m["default"]},props:{detailState:{type:Boolean,default:!1}},data:function(){var t=this;return{formData:{content:""},backOption:{isBack:!0,backPath:null,backFunction:function(){t.detailState?t.$emit("backPage",!1):t.$router.go(-1)}},comment:p(),commentList:[],materialTotal:0,greatMaterialList:[],isCommentShow:!1,createCollect:u["c"],pageSize:v,isDelete:!0,firstClass:[]}},computed:Object(r["a"])({},Object(d["c"])(["dictGroup"])),methods:{submit:function(){var t=this;""!=this.comment.commentContent?(this.comment.commentObjectId=this.formData.id,Object(o["b"])(this.comment).then(function(){t.getComment(t.formData.id),t.comment=p()})):this.$message.error("请先填写评论的内容！")},Instructions:function(){this.$refs["instrDialog"].open()},getComment:function(t){var e=this;Object(o["c"])({id:t,objectType:1,size:this.pageSize.size,current:this.pageSize.current}).then(function(t){var a=t.data;e.commentList=a.data.records,e.pageSize.total=a.data.total})},downLoad:function(t){this.formData.downloadCost>0?this.$message.error("对不起，您的余额不足！"):(Object(c["a"])(t),Object(s["c"])(this.formData.id))},handleDetail:function(t){this.$router.push("/mlms_spa/material/detail/".concat(t.id))},getDataById:function(t){var e=this;Object(s["d"])(t).then(function(t){var a=t.data;if(!a.data)return e.$message.error(a.msg),void(e.isDelete=!1);e.formData=a.data,e.getComment(a.data.id),Object(s["e"])(a.data.creator).then(function(t){var a=t.data;e.greatMaterialList=a}),Object(s["g"])(a.data.creator).then(function(t){var a=t.data;e.materialTotal=a.data})})},open:function(t){this.getDataById(t)},subscribe:function(){this.$message.info("抱歉，此功能正在开发中")},apprentice:function(){this.$message.info("抱歉，此功能正在开发中")},handleCollect:function(){if(1!=this.formData.collection){var t=Object(r["a"])({},this.formData);t.title=t.materialName,this.$refs["collection"].dialogShow=!0,this.$refs["collection"].loadCollectList([t])}else this.$message.warning("该材料已收藏，请勿重复操作！")},handleShare:function(){this.formData.name=this.formData.materialName,this.$refs["share"].open([this.formData],"关于 ".concat(this.formData.name," 材料的分享"))},handleWrong:function(){this.$refs["wrong"].open({subject:"纠错：".concat(this.formData.materialName),receiverIds:[this.formData.creator],receiverName:this.formData.creatorRealName})},handleComment:function(){this.isCommentShow=!this.isCommentShow},handleReward:function(){this.$message.info("抱歉，此功能正在开发中")},loadPage:function(){this.formData.collection=1,this.$emit("load-page",!0)},handleCurrentChange:function(t){this.pageSize.current=t,this.getComment(this.formData.id)},getMoney:function(t){var e=!0,a=!1,i=void 0;try{for(var n,r=this.dictGroup.mlms_download_cost[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value;if(s.value==t)return s.label}}catch(o){a=!0,i=o}finally{try{e||null==r.return||r.return()}finally{if(a)throw i}}},getClass:function(t,e){var a={},i=!0,n=!1,r=void 0;try{for(var s,o=this.firstClass[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){var c=s.value;if(c.id==t){a.first=c.levelName;var l=!0,u=!1,m=void 0;try{for(var f,d=c.childrens[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var h=f.value;if(h.id==e)return a.second=h.levelName,a}}catch(p){u=!0,m=p}finally{try{l||null==d.return||d.return()}finally{if(u)throw m}}}}}catch(p){n=!0,r=p}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}}},created:function(){var t=this,e=this.$route.params;e.id&&"查看文档"==this.$route.name&&this.getDataById(e.id),Object(h["c"])().then(function(e){var a=e.data;t.firstClass=a.data})},beforeRouteUpdate:function(t,e,a){this.getDataById(t.params.id),a()}},b=g,y=(a("5b3c"),a("2877")),D=Object(y["a"])(b,i,n,!1,null,"1429685e",null);e["default"]=D.exports},e97f:function(t,e,a){"use strict";a("0814")},f1fc:function(t,e,a){}}]);