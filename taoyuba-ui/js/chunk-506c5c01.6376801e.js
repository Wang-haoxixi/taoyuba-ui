(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-506c5c01"],{"0910":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contract-box"},[r("basic-container",[r("h1",[e._v(e._s(e.$route.query.see?"查看":e.$route.query.edit?"编辑":"新增")+"船东信息")]),r("el-form",{ref:"form",attrs:{model:e.shipowner,"label-width":"150px",rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"姓名:",prop:"realName"}},[e.$route.query.see?r("div",[e._v(e._s(e.shipowner.realName))]):r("el-select",{attrs:{placeholder:"请选择渔船名"},on:{change:e.realNameChange},model:{value:e.shipowner.realName,callback:function(t){e.$set(e.shipowner,"realName",t)},expression:"shipowner.realName"}},e._l(e.realNameList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"身份证号:",prop:"idcard"}},[e.$route.query.see?r("div",[e._v(e._s(e.shipowner.idcard))]):r("el-input",{attrs:{placeholder:"",disabled:e.haveInfo.idcard},model:{value:e.shipowner.idcard,callback:function(t){e.$set(e.shipowner,"idcard",t)},expression:"shipowner.idcard"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"联系地址:",prop:"address"}},[e.$route.query.see?r("div",[e._v(e._s(e.shipowner.address))]):r("el-input",{attrs:{placeholder:""},model:{value:e.shipowner.address,callback:function(t){e.$set(e.shipowner,"address",t)},expression:"shipowner.address"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"手机号码:",prop:"phone"}},[e.$route.query.see?r("div",[e._v(e._s(e.shipowner.phone))]):r("el-input",{attrs:{placeholder:"",disabled:e.haveInfo.phone,readonly:e.isReadonly},model:{value:e.shipowner.phone,callback:function(t){e.$set(e.shipowner,"phone",t)},expression:"shipowner.phone"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"所属行政村：",prop:"regionId"}},[e.$route.query.see?r("div",[e._v(e._s(e.shipowner.regionId))]):r("el-cascader",{attrs:{options:e.options,props:e.props},on:{"active-item-change":e.handleItemChange},model:{value:e.shipowner.regionId,callback:function(t){e.$set(e.shipowner,"regionId",t)},expression:"shipowner.regionId"}})],1)],1)],1)],1),r("div",{staticStyle:{"text-align":"center"}},[e.$route.query.see?e._e():r("el-button",{on:{click:e.save}},[e._v("提交")]),r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),e.manager?r("el-button",{on:{click:e.collect}},[e._v("数据读取")]):e._e()],1)],1)],1)},_=[],n=r("8889"),i=n["a"],o=(r("4154"),r("2877")),s=Object(o["a"])(i,a,_,!1,null,"8e623fae",null);t["default"]=s.exports},"2f9e":function(e,t,r){"use strict";r.d(t,"a",function(){return _});r("ac6a"),r("28a5"),r("a481");var a=r("b5c6");function _(e){var t=e.url,r=e.method,_=void 0===r?"post":r,i=e.data,o=void 0===i?{}:i,s=e.title,c=void 0===s?"":s;return new Promise(function(e){return Object(a["a"])({url:t,method:_,headers:{responseType:"arraybuffer"},data:o,responseType:"blob"}).then(function(t){n({title:c,response:t}).then(function(){e()})})})}function n(e){var t=e.title,r=void 0===t?"":t,a=e.response,_=i(a.headers["content-disposition"].replace(/"/g,""));return new Promise(function(e){var t=a.headers,n=new Blob([a.data],{type:t["content-type"]});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,r);else{var i=document.createElement("a");i.href=window.URL.createObjectURL(n),i.download=r?"".concat(r,".").concat(_.suffix):_.filename,document.body.appendChild(i),i.style.display="none",i.click()}e()})}function i(e){var t={},r=e.split(";");return r.forEach(function(e){var r=e.replace(/^\s+|\s+$/g,""),a=r.split("=");a[1]?t[a[0]]=a[1]:t[a[0]]=a[0]}),t.suffix=t.filename.split(".")[1],t}},4154:function(e,t,r){"use strict";r("556c")},4917:function(e,t,r){"use strict";var a=r("cb7c"),_=r("9def"),n=r("0390"),i=r("5f1b");r("214f")("match",1,function(e,t,r,o){return[function(r){var a=e(this),_=void 0==r?void 0:r[t];return void 0!==_?_.call(r,a):new RegExp(r)[t](String(a))},function(e){var t=o(r,e,this);if(t.done)return t.value;var s=a(e),c=String(this);if(!s.global)return i(s,c);var d=s.unicode;s.lastIndex=0;var u,l=[],h=0;while(null!==(u=i(s,c))){var p=String(u[0]);l[h]=p,""===p&&(s.lastIndex=n(c,_(s.lastIndex),d)),h++}return 0===h?null:l}]})},"556c":function(e,t,r){},"6c21":function(e,t,r){"use strict";r.d(t,"g",function(){return i}),r.d(t,"j",function(){return o}),r.d(t,"a",function(){return s}),r.d(t,"h",function(){return c}),r.d(t,"d",function(){return d}),r.d(t,"b",function(){return u}),r.d(t,"e",function(){return l}),r.d(t,"k",function(){return h}),r.d(t,"l",function(){return p}),r.d(t,"f",function(){return f}),r.d(t,"i",function(){return m}),r.d(t,"c",function(){return E});var a=r("b5c6"),_=r("2f9e"),n="/tmlms/ship_owner";function i(e){return Object(a["a"])({url:"".concat(n,"/page"),method:"get",params:e})}function o(e,t){return Object(a["a"])({url:"".concat(n,"/create?type=").concat(t),method:"post",data:e})}function s(e){return Object(a["a"])({url:"".concat(n,"/delete?idcard=").concat(e),method:"post"})}function c(e){return Object(a["a"])({url:"".concat(n,"/getDetail?idcard=").concat(e),method:"get"})}function d(e){return Object(a["a"])({url:"admin/region/wholeInfoList?areaCode=".concat(e),method:"get"})}function u(e,t){return Object(a["a"])({url:"".concat(n,"/edit?type=").concat(t),method:"post",data:e})}function l(e){return Object(a["a"])({url:"admin/region/wholeInfo?areaCode=".concat(e),method:"get"})}function h(e,t){return Object(a["a"])({url:"".concat(n,"/newReview?status=").concat(e,"&idcard=").concat(t),method:"post"})}function p(e){return Object(a["a"])({url:"admin/file/upload/avatar",method:"post",data:e})}function f(e){return Object(a["a"])({url:"".concat(n,"/idcardcheck"),method:"get",params:{idcard:e}})}function m(e,t){return Object(a["a"])({url:"".concat(n,"/newedit?type=").concat(t),method:"post",data:e})}function E(e){return Object(_["a"])({url:"tmlms/tybmlmsExcelExport/downloadOwner",data:e,title:"船东信息"})}},8889:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("6762"),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("2fdb"),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_2__),D_P_M_taoyuba_ui_node_modules_babel_runtime_helpers_esm_typeof_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("53ca"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("7f7f"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("4917"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6__),_api_post_address__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("23d6"),_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("6c21"),_api_login__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("7ded"),_api_hrms_databuspayload__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("b440"),_api_tmlms_bvillage_villageship__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("da1c"),vue__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("2b0e"),_mixins_information__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("e420"),vue_socket_io__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("5132"),vue_socket_io__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(vue_socket_io__WEBPACK_IMPORTED_MODULE_14__),lodash_debounce__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("b047"),lodash_debounce__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(lodash_debounce__WEBPACK_IMPORTED_MODULE_15__);vue__WEBPACK_IMPORTED_MODULE_12__["default"].use(new vue_socket_io__WEBPACK_IMPORTED_MODULE_14___default.a({debug:!0,connection:"http://localhost:5000"})),__webpack_exports__["a"]={mixins:[_mixins_information__WEBPACK_IMPORTED_MODULE_13__["a"]],data:function(){this.getidcardList=lodash_debounce__WEBPACK_IMPORTED_MODULE_15___default()(this.getidcardList,800);var e=function(e,t,r){""===t?r(new Error("请输入身份证号")):t.match(/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/)?r():r(new Error("请输入正确的身份证号码!"))},t=function(e,t,r){""===t?r(new Error("请输入联系电话")):t.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/)?r():r(new Error("请输入正确的手机号码!"))};return{haveInfo:{phone:!1},certificateColumns:[{prop:"shipName",label:"渔船名"},{prop:"shipNo",label:"渔船编号"},{prop:"licensesFishingNo",label:"捕捞许可证编号"},{prop:"licensesOwnerShip",label:"渔船所有权登记证书"},{prop:"licensesNationalNo",label:"国籍证书编号"},{prop:"licensesInspectionNo",label:"船舶检验证书编号"}],shipowner:{shiplist:[],address:"",idcard:"",realName:"",phone:"",regionId:""},rules:{realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],idcard:[{required:!0,message:"请输入身份证号",trigger:"blur"},{validator:e,trigger:"blur"}],address:[{required:!0,message:"请输入联系地址",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:t,trigger:"blur"}],regionId:[{required:!0,message:"请输入所属行政村",trigger:"blur"}]},options:[],props:{value:"areaCode",label:"name",children:"childList"},arr:[],sn:"",manager:!1,idcards:[],loading:!1,isReadonly:!1,realNameList:[],cId:""}},methods:{save:function(){var e=this;this.$refs["form"].validate(function(t){if(e.shipowner.regionId&&(e.shipowner.regionId=e.shipowner.regionId[e.shipowner.regionId.length-1]),t){var r=JSON.parse(JSON.stringify(e.shipowner)),a="";a=e.manager?1:3,e.$route.query.edit?Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["b"])(r,a).then(function(t){e.$message({message:t.data.msg,type:"success"}),e.$router.go(-1)}).catch(function(t){e.$message.error(t.message)}):Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["j"])(r,a).then(function(t){e.$message({message:t.data.msg,type:"success"}),e.$router.go(-1)}).catch(function(t){e.$message.error(t.message)})}})},handleItemChange:function(e){var t=this;Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["c"])(e[e.length-1]).then(function(r){var a=r.data.data;t.getNode(t.options,e[e.length-1],a)})},getNode:function(e,t,r){var a=this;e.forEach(function(e){e.areaCode==t?(e.childList=r,e.level<3&&e.childList.forEach(function(e){void 0===e.childList&&a.$set(e,"childList",[])})):e.childList&&0!==e.childList.length&&a.getNode(e.childList,t,r)})},setData:function(e){this.shipowner.shiplist=e},getarr:function(e){this.$route.query.edit?(this.arr.push(e.areaCode),e.child&&this.getarr(e.child)):this.$route.query.see&&(this.arr instanceof Array&&(this.arr=""),this.arr="".concat(this.arr).concat(this.arr?"/":"").concat(e.name),e.child&&this.getarr(e.child))},collect:function(){var e=this;this.sn="",Object(_api_hrms_databuspayload__WEBPACK_IMPORTED_MODULE_10__["a"])({sn:this.sn}).then(function(t){e.shipowner.address=t.data.data.address,e.shipowner.idcard=t.data.data.identityNumber,e.shipowner.realName=t.data.data.name})},idcardChange:function(e){"object"===Object(D_P_M_taoyuba_ui_node_modules_babel_runtime_helpers_esm_typeof_js__WEBPACK_IMPORTED_MODULE_3__["a"])(e)?this.refreshCard(e):this.refreshCard({idcard:e}),this.idcards=[]},refreshCard:function(e){if(null!==e){var t=e.idcard,r=void 0===t?"":t,a=e.phone,_=void 0===a?"":a;this.shipowner.phone=_,this.shipowner.idcard=r,this.isReadonly=""!==_}else this.shipowner.phone="",this.shipowner.idcard="",this.isReadonly=!1},getidcardList:function(e){var t=this;this.loading=!0,this.isReadonly=!1,""!==e?Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["f"])(e).then(function(e){var r=e.data;!0!==r.data&&t.idcards.push(r.data)}):this.idcards=[],this.loading=!1},getrealNameList:function(){var e=this;Object(_api_login__WEBPACK_IMPORTED_MODULE_9__["c"])().then(function(t){e.userId=t.data.data.sysUser.userId,Object(_api_tmlms_bvillage_villageship__WEBPACK_IMPORTED_MODULE_11__["e"])(e.userId).then(function(t){e.realNameList=t.data.data.map(function(e){return{label:e.shipowner,value:e.shipowner}})})})},realNameChange:function(e){var t=this;Object(_api_tmlms_bvillage_villageship__WEBPACK_IMPORTED_MODULE_11__["d"])(e).then(function(e){t.shipowner.phone=e.data.data.mobile})},getData:function(){var e=this;this.$route.query.edit&&(this.cId=this.$route.query.edit),this.$route.query.see&&(this.cId=this.$route.query.see),(this.$route.query.edit||this.$route.query.see)&&Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["h"])(this.cId).then(function(t){0===t.data.code&&(0!==t.data.data.regionId&&Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["a"])(t.data.data.regionId).then(function(t){e.options=t.data.data}),0===t.data.data.regionId?(e.shipowner=t.data.data,Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["c"])(0).then(function(t){e.options=t.data.data,e.options.forEach(function(t){e.$set(t,"childList",[])})}),e.shipowner.regionId=e.options,e.$route.query.see&&(e.typeList.forEach(function(t){e.shipowner.regionType===t.value&&(e.shipowner.regionType=t.label)}),e.shipowner.regionId="")):Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["b"])(t.data.data.regionId).then(function(r){e.getarr(r.data.data,e.arr),t.data.data.regionId=e.arr,e.shipowner=t.data.data,e.$route.query.see&&(e.typeList.forEach(function(t){e.shipowner.regionType===t.value&&(e.shipowner.regionType=t.label)}),e.shipowner.regionId.forEach(function(t){e.shipowner.regionId="",Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["d"])(t).then(function(t){e.shipowner.regionId+=t.data.data.name})}))}))})}},computed:{},beforeDestroy:function(){this.sockets.unsubscribe("card message")},created:function(){var e=this;(this.$route.query.see||this.$route.query.edit)&&this.getData(),Object(_api_login__WEBPACK_IMPORTED_MODULE_9__["c"])().then(function(t){t.data.data.roles.includes(111)?e.manager=!0:e.manager=!1,t.data.data.sysUser.userId}),this.getrealNameList()},mounted:function mounted(){var _this10=this;function Base64(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.decode=function(r){var a,_,n,i,o,s,c,d="",u=0;r=r.replace(/[^A-Za-z0-9+/=]/g,"");while(u<r.length)i=e.indexOf(r.charAt(u++)),o=e.indexOf(r.charAt(u++)),s=e.indexOf(r.charAt(u++)),c=e.indexOf(r.charAt(u++)),a=i<<2|o>>4,_=(15&o)<<4|s>>2,n=(3&s)<<6|c,d+=String.fromCharCode(a),64!=s&&(d+=String.fromCharCode(_)),64!=c&&(d+=String.fromCharCode(n));return d=t(d),d};var t=function(e){var t="",r=0,a=0,_=0,n=0;while(r<e.length)a=e.charCodeAt(r),a<128?(t+=String.fromCharCode(a),r++):a>191&&a<224?(_=e.charCodeAt(r+1),t+=String.fromCharCode((31&a)<<6|63&_),r+=2):(_=e.charCodeAt(r+1),n=e.charCodeAt(r+2),t+=String.fromCharCode((15&a)<<12|(63&_)<<6|63&n),r+=3);return t}}this.$socket.emit("connect"),this.$socket.emit("startRead"),this.sockets.subscribe("card message",function(msg){var base=new Base64,result1=base.decode(msg),data=eval("("+result1+")");_this10.$set(_this10.shipowner,"realName",data.name),_this10.$set(_this10.shipowner,"idcard",data.cardno),_this10.$set(_this10.shipowner,"address",data.address)})}}},b440:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var a=r("b5c6"),_="/tybhrms/databuspayload";function n(e){return Object(a["a"])({url:"".concat(_,"/getlast"),method:"get",params:e})}},da1c:function(e,t,r){"use strict";r.d(t,"e",function(){return n}),r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return s}),r.d(t,"d",function(){return c});var a=r("b5c6"),_="/tmlms/tybvillageshipinfo";function n(e){return Object(a["a"])({url:"".concat(_,"/getbyuser/").concat(e),method:"get"})}function i(e){return Object(a["a"])({url:"".concat(_,"/batchship"),method:"post",data:e})}function o(e,t){return Object(a["a"])({url:"".concat(_,"/batchedit?userId=").concat(t),method:"post",data:e})}function s(e){return Object(a["a"])({url:"".concat(_,"/").concat(e),method:"get"})}function c(e){return Object(a["a"])({url:"".concat(_,"/getbyShipowner"),method:"get",params:{shipowner:e}})}},e420:function(e,t,r){"use strict";r("7f7f");var a=r("7ded");t["a"]={data:function(){return{haveInfo:{}}},methods:{getInformation:function(e,t){var r=this;Object(a["c"])().then(function(a){-1===a.data.data.roles.indexOf(1)&&-1===a.data.data.roles.indexOf(111)&&(a.data.data.sysUser.phone&&(r.$set(r.haveInfo,"phone",!0),r[e][t[0]]=a.data.data.sysUser.phone),a.data.data.sysUser.realName&&(r.$set(r.haveInfo,"realName",!0),r[e][t[1]]=a.data.data.sysUser.realName),a.data.data.sysUser.idCard&&[t[2]]&&(r.$set(r.haveInfo,"idcard",!0),r[e].idcard=a.data.data.sysUser.idCard))})}}}}}]);