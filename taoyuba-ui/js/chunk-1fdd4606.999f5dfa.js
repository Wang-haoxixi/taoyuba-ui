(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1fdd4606"],{"244c":function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"d",(function(){return l})),r.d(e,"c",(function(){return i})),r.d(e,"b",(function(){return c})),r.d(e,"e",(function(){return s}));var a=r("b5c6"),o="/tybhrms/tybbook";function n(t){return Object(a["a"])({url:"".concat(o,"/save"),method:"post",data:t})}function l(t){return Object(a["a"])({url:"".concat(o,"/page"),method:"get",params:t})}function i(t){return Object(a["a"])({url:"".concat(o,"/").concat(t),method:"get"})}function c(t){return Object(a["a"])({url:"".concat(o,"/del/").concat(t),method:"post"})}function s(t){return Object(a["a"])({url:"".concat(o,"/update"),method:"post",data:t})}},"3d64":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"iep-page-form"},[r("basic-container",[r("page-header",{attrs:{title:t.getTitle,backOption:t.backOption}}),r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"150px",size:"small",disabled:t.isDisabled}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"单位名称：",prop:"department"}},[r("el-input",{model:{value:t.form.department,callback:function(e){t.$set(t.form,"department",e)},expression:"form.department"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收件地址：",prop:"address"}},[r("el-input",{model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"联系人：",prop:"contactName"}},[r("el-input",{model:{value:t.form.contactName,callback:function(e){t.$set(t.form,"contactName",e)},expression:"form.contactName"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"电话：",prop:"phone"}},[r("el-input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"付款方名称：",prop:"payerTitle"}},[r("el-input",{model:{value:t.form.payerTitle,callback:function(e){t.$set(t.form,"payerTitle",e)},expression:"form.payerTitle"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"纳税人识别号：",prop:"payerTaxNum"}},[r("el-input",{model:{value:t.form.payerTaxNum,callback:function(e){t.$set(t.form,"payerTaxNum",e)},expression:"form.payerTaxNum"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"付款方地址：",prop:"payerAddress"}},[r("el-input",{model:{value:t.form.payerAddress,callback:function(e){t.$set(t.form,"payerAddress",e)},expression:"form.payerAddress"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"付款方电话：",prop:"payerPhone"}},[r("el-input",{model:{value:t.form.payerPhone,callback:function(e){t.$set(t.form,"payerPhone",e)},expression:"form.payerPhone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开户行：",prop:"payerBank"}},[r("el-input",{model:{value:t.form.payerBank,callback:function(e){t.$set(t.form,"payerBank",e)},expression:"form.payerBank"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账号：",prop:"payerAccount"}},[r("el-input",{model:{value:t.form.payerAccount,callback:function(e){t.$set(t.form,"payerAccount",e)},expression:"form.payerAccount"}})],1)],1)],1)],1),r("page-header",{staticStyle:{"margin-top":"50px"},attrs:{title:"书目清单"}}),r("el-table",{ref:"multipleTable",staticStyle:{width:"70%","margin-left":"100px"},attrs:{data:t.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"},"tooltip-effect":"dark",height:"350"},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",selectable:t.isa}}),r("el-table-column",{attrs:{prop:"title",label:"书 目",width:"300"}}),r("el-table-column",{attrs:{prop:"price",label:"单价",width:"120"}}),r("el-table-column",{attrs:{prop:"quantity",label:"订购数（册）"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-input-number",{staticStyle:{width:"50%"},attrs:{min:0,size:"mini"},on:{blur:function(r){return t.handleChange(e.row)}},model:{value:e.row.quantity,callback:function(r){t.$set(e.row,"quantity",r)},expression:"scope.row.quantity"}})]}}])}),r("el-table-column",{attrs:{label:"小计金额（元）",prop:"total",width:"120"}})],1),r("div",{staticStyle:{"margin-left":"100px","margin-top":"50px"}},[t._v("合计："+t._s(t.form.amount))]),r("operation-wrapper",{staticStyle:{"margin-left":"50px","margin-top":"50px"}},[r("iep-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("订购")])],1)],1)],1)},o=[],n=(r("ac6a"),r("4917"),r("244c")),l=r("fcea"),i={data:function(){var t=this,e=function(t,e,r){""===e?r(new Error("请输入联系电话")):e.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[0-9]|19[0-9]|16[0-9])[0-9]{8}$/)?r():r(new Error("请输入正确的手机号码!"))};return{backOption:{isBack:!0,backPath:null,backFunction:function(){t.onGoBack()}},form:{department:"",address:"",contactName:"",phone:"",payerTitle:"",payerTaxNum:"",payerAddress:"",payerPhone:"",payerBank:"",payerAccount:"",amount:0,tybBookOrderLists:[]},rules:{department:[{required:!0,message:"请输入单位名称",trigger:"blur"}],address:[{required:!0,message:"请输入收件地址",trigger:"blur"}],contactName:[{required:!0,message:"请输入联系人",trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"},{validator:e,trigger:"blur"}],payerTitle:[{required:!0,message:"请输入付款方名称",trigger:"blur"}],payerTaxNum:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}],payerAddress:[{required:!0,message:"请输入付款方地址",trigger:"blur"}],payerPhone:[{required:!0,message:"请输入付款方电话",trigger:"blur"},{validator:e,trigger:"blur"}],payerBank:[{required:!0,message:"请输入开户行",trigger:"blur"}],payerAccount:[{required:!0,message:"请输入账号",trigger:"blur"}]},tableData:[],multipleSelection:[]}},created:function(){var t=this;this.bookList(),this.$route.query.see&&Object(l["c"])(this.$route.query.see).then((function(e){t.form=e.data.data,t.form.tybBookOrderLists?(t.tableData=t.form.tybBookOrderLists.map((function(t){return{bookId:t.bookId,title:t.title,quantity:t.quantity,price:t.price,total:t.quantity*t.price}})),t.$nextTick((function(){t.tableData.forEach((function(e){t.$refs["multipleTable"].toggleRowSelection(e)}))}))):t.tableData=[]}))},methods:{bookList:function(){var t=this;Object(n["d"])().then((function(e){t.bookList=e.data.data.records,t.tableData=t.bookList.map((function(t){return{bookId:t.id,title:t.title,quantity:0,price:t.price,total:0}}))}))},onGoBack:function(){this.$router.push({path:"/textbook_spa/order_list"})},handleSelectionChange:function(t){var e=this;this.multipleSelection=t,"{}"===JSON.stringify(this.$route.query)&&(this.form.amount=0,this.multipleSelection.forEach((function(t){e.form.amount+=t.total})))},handleRowClick:function(t){var e=this;t.total=t.price*t.quantity,this.multipleSelection.length>0&&(this.form.amount=0,this.multipleSelection.forEach((function(t){e.form.amount+=t.total})))},handleChange:function(t){this.handleRowClick(t)},save:function(){var t=this;0===this.form.amount&&this.multipleSelection.length>0?this.$message.error("总计不能为空！"):(this.multipleSelection.length>0&&(this.form.tybBookOrderLists=this.multipleSelection),this.$refs.form.validate((function(e){0===t.multipleSelection.length&&(t.$message.error("教材订单书目清单不能为空！"),e=!1),t.multipleSelection.length>0&&t.multipleSelection.forEach((function(r){0===r.total&&(t.$message.error("订购数不能为空！"),e=!1)})),e&&"{}"===JSON.stringify(t.$route.query)&&Object(l["e"])(t.form).then((function(){t.$message.success("提交成功！"),t.$router.push({path:"/textbook_spa/order_list"})})).catch((function(e){t.$message.error(e.msg)}))})))},isa:function(){return!this.isDisabled}},computed:{getTitle:function(){return"".concat("{}"===JSON.stringify(this.$route.query)?"新增":"查看","教材订购")},isDisabled:function(){return"{}"!==JSON.stringify(this.$route.query)}},watch:{}},c=i,s=r("2877"),u=Object(s["a"])(c,a,o,!1,null,null,null);e["default"]=u.exports},4917:function(t,e,r){"use strict";var a=r("cb7c"),o=r("9def"),n=r("0390"),l=r("5f1b");r("214f")("match",1,(function(t,e,r,i){return[function(r){var a=t(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,a):new RegExp(r)[e](String(a))},function(t){var e=i(r,t,this);if(e.done)return e.value;var c=a(t),s=String(this);if(!c.global)return l(c,s);var u=c.unicode;c.lastIndex=0;var p,m=[],f=0;while(null!==(p=l(c,s))){var d=String(p[0]);m[f]=d,""===d&&(c.lastIndex=n(s,o(c.lastIndex),u)),f++}return 0===f?null:m}]}))},fcea:function(t,e,r){"use strict";r.d(e,"e",(function(){return n})),r.d(e,"d",(function(){return l})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return c})),r.d(e,"f",(function(){return s})),r.d(e,"b",(function(){return u}));var a=r("b5c6"),o="/tybhrms/tybbookorder";function n(t){return Object(a["a"])({url:"".concat(o,"/save"),method:"post",data:t})}function l(t){return Object(a["a"])({url:"".concat(o,"/page"),method:"get",params:t})}function i(t){return Object(a["a"])({url:"".concat(o,"/").concat(t),method:"get"})}function c(t){return Object(a["a"])({url:"".concat(o,"/cancel/").concat(t),method:"post"})}function s(t){return Object(a["a"])({url:"".concat(o,"/ticket"),method:"get",params:t})}function u(t){return Object(a["a"])({url:"".concat(o,"/delivery"),method:"get",params:t})}}}]);