(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-508d0dd2"],{"056e":function(e,t,n){},"09d2":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("basic-container",[n("page-header",{attrs:{title:e.shipTitle}}),n("operation-container",[n("template",{slot:"left"},[n("iep-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("上船登记")]),e.relation_ship_add?n("iep-button",{attrs:{type:"default"},on:{click:e.handleAddRelation}},[e._v("新增联系记录")]):e._e()],1),n("template",{slot:"right"},[n("el-button",{attrs:{size:"small"},on:{click:e.backPage}},[e._v("返回")])],1)],2),n("iep-table",{attrs:{"cell-style":e.tableCellStyle,isLoadTable:!1,isPagination:!1,pagination:e.pagination,columnsMap:e.allcrewColumnsMap,dictsMap:e.dictsMap,pagedTable:e.pagedTable,emptyText:e.message,"is-mutiple-selection":""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"selection-change":e.handleSelectionChange}},[n("template",{slot:"before-columns"},[n("el-table-column",{attrs:{label:"姓名",width:"180",prop:"realName"},scopedSlots:e._u([{key:"default",fn:function(t){return["上船，未签合同"==t.row.workStatus||0==t.row.signStatus&&14!=t.row.positionId&&0!=t.row.positionId||""==t.row.idcard||e.checIdCard(t.row.idcard)||""==t.row.phone||e.checkPhone(t.row.phone)?n("el-popover",{attrs:{trigger:"hover",placement:"top"}},[""==t.row.idcard||e.checIdCard(t.row.idcard)?n("p",[e._v("身份证缺失或有误")]):e._e(),""==t.row.phone||e.checkPhone(t.row.phone)?n("p",[e._v("联系方式缺失或有误")]):e._e(),"上船，未签合同"==t.row.workStatus?n("p",[e._v("上船未签合同")]):e._e(),0==t.row.signStatus&&14!=t.row.positionId&&0!=t.row.positionId?n("p",[e._v("未培训")]):e._e(),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e._v("\n            "+e._s(t.row.realName)+"\n          ")])]):n("div",[e._v("\n            "+e._s(t.row.realName)+"\n        ")])]}}])})],1),n("el-table-column",{attrs:{prop:"operation",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("operation-wrapper",[n("iep-button",{attrs:{size:"mini",plain:""},on:{click:function(n){return e.handleEdit(t.row.idcard)}}},[e._v("编辑")]),n("iep-button",{attrs:{size:"mini",plain:""},on:{click:function(n){return e.handleChange(t.row.idcard)}}},[e._v("变更")]),n("iep-button",{attrs:{size:"mini",plain:""},on:{click:function(n){return e.handleView(t.row.idcard)}}},[e._v("查看")]),t.row.sign?n("iep-button",{attrs:{size:"mini",plain:""},on:{click:function(n){return e.handleSign(t.row.idcard)}}},[e._v("合同")]):e._e(),t.row.sign?e._e():n("iep-button",{attrs:{size:"mini",plain:""},on:{click:function(n){return e.contractAdd(t.row.idcard)}}},[e._v("签合同")]),e.roles.includes(115)?e._e():n("iep-button",{attrs:{size:"mini",plain:""},on:{click:function(n){return e.handleDelete(t.row.idcard)}}},[e._v("删除")])],1)]}}])})],2)],1),n("dialog-form-relation",{ref:"dialogFormRelation",attrs:{status:e.relationStatus},model:{value:e.formRelation,callback:function(t){e.formRelation=t},expression:"formRelation"}}),n("change-man",{ref:"changeMan",on:{back:function(t){return e.getData()}}})],1)},a=[],o=(n("8e6e"),n("456d"),n("6b54"),n("ac6a"),n("28a5"),n("96cf"),n("1da1")),i=n("ade3"),c=n("5612"),s=n("b461"),u=n("c533"),l=n("266e"),d=n("502e"),p=n("8b00"),h=n("7ded"),m=n("4151"),f=n.n(m),g=n("2f62"),b=n("51f8"),v=n("8003");function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={mixins:[d["a"],v["a"]],components:{dialogFormRelation:b["default"],changeMan:s["default"]},data:function(){return{row:"",relationStatus:"",dictsMap:p["h"],form:{idcard:"",workStatus:"",reason:""},certLevel:[{value:"0",label:""},{value:"1",label:"一级"},{value:"2",label:"二级"},{value:"3",label:"三级"}],reasons:[{label:"船员觉得开船时间太久",value:0},{label:"船员觉得工资太低",value:1},{label:"船员工作不认真",value:2}],allcrewColumnsMap:p["c"],searchData:"contactName",message:"此渔船暂无相关船员",manager:!1,shipId:"",userData:{},dialogCrewVisible:!1,workStatus:[{label:"未用工",value:0},{label:"上船，已签合同",value:1},{label:"离船，未解除合同 ",value:2},{label:"上船，未签合同",value:3},{label:"离船，未签合同",value:4},{label:"待求职",value:9}],flag:[{label:"设备",value:1},{label:"微信",value:2},{label:"变更登记",value:3}],rules:{reason:[{required:!0,message:"该选项必填！",trigger:"blur"}]},conCrew:[],shipTitle:"",formRelation:{},relation_ship_add:!1}},created:function(){this.getData()},computed:O({},Object(g["c"])(["roles","permissions"])),methods:{checIdCard:p["d"],checkPhone:p["e"],tableCellStyle:function(e){var t=e.row,n=e.column;if("姓名"==n.label&&(0==t.signStatus&&14!=t.positionId&&0!=t.positionId||"上船，未签合同"==t.workStatus||""==t.idcard||Object(p["d"])(t.idcard)||""==t.phone||Object(p["e"])(t.phone)))return"color:red"},getData:function(){var e=this;this.getRogionList().then((function(){e.getTableData()})).catch((function(){e.getTableData()})),this.isManager(),this.getTitle(),this.formRelation.shipName=this.$route.query.shipName,this.formRelation.shipownerName=this.$route.query.shipowner,this.formRelation.shipownerPhone=this.$route.query.mobile,this.relation_ship_add=this.permissions["relation_ship_add"]},handleView:function(e){this.$router.push({name:"detailBoatMan",query:{see:e}})},handleAddRelation:function(){this.relationStatus="add",this.$refs.dialogFormRelation.open()},getTitle:function(){this.shipTitle=this.$route.query.shipName+"渔船船员"},handleChange:function(e){this.$refs.changeMan.dialogVisible=!0,this.$refs.changeMan.getOption(e)},handleSelectionChange:function(e){this.multipleSelection=e.map((function(e){return e.id}))},handleAdd:function(){this.$router.push({path:"/hrms_spa/ship_allcrew_add/".concat(this.$route.params.shipId),query:{shipName:this.$route.query.shipName}})},handleSign:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=window.location.href.split("/")[2],r="%7B%7D",e.next=4,Object(l["e"])(t).then((function(e){return e.data.data.contractId}));case 4:a=e.sent,this.$openPage("//".concat(n,"/api/tmlms/downLoad/intoContractHtml?contractId=").concat(a,"&dataMap=").concat(r),"url");case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleEdit:function(e){this.$router.push({name:"detailBoatMan",query:{edit:e,shipCrew:!0}})},handleDelete:function(e){var t=this;this.$confirm("确定删除该船员吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["e"])(e,t.$route.params.shipId).then((function(e){console.log(e),t.$message.success("船员删除成功!"),t.getTableData()}))}))},contractAdd:function(e){console.log(e),this.$router.push({path:"/tmlms_spa/contract_add",query:{add:"add",hdkId:e}})},getTableData:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["j"])(this.$route.params.shipId);case 2:t=e.sent,t.data.data.map((function(e){if(1==e.workStatus&&(e.sign=1),e.workStatus=f()(r.workStatus,"value")[e.workStatus].label,e.flag=f()(r.flag,"value")[e.flag].label,e.certList){var t="";e.certName="",e.certList.forEach((function(n){r.certLevel.map((function(e){n.certLevel===e.value&&(t=e.label)})),r.$store.getters.dictGroup.tyb_crew_cert_title.map((function(e){n.certTitle==e.value&&(t+=e.label+",")})),console.log(t),t&&(t=t.slice(0,t.length-1)),e.certName=t}))}})),n=t.data.data,n.forEach((function(e){e.provinceId&&(e.provinceIdName=r.getProvinceIdName(e.provinceId))})),this.pagedTable=t.data.data;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),loadPage:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:this.searchForm,t.shipId=this.$route.params.shipId,e.next=4,Object(c["j"])(t.shipId);case 4:n=e.sent,console.log(n);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleProtocol:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=window.location.href.split("/")[2],r="%7B%7D",e.next=4,Object(l["e"])(t).then((function(e){return e.data.data.contractId}));case 4:a=e.sent,this.$openPage("//".concat(n,"/api/tmlms/downLoad/intoContractHtml?contractId=").concat(a,"&dataMap=").concat(r),"url");case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleInsure:function(e){console.log(e),this.$router.push({path:"/hrms_spa/shipCrew_Insure/".concat(e)})},handleCrew:function(e,t){var n=this;this.$confirm("您确定此船员离船?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(n.form.idcard=e.toString(),n.workStatus.map((function(e){if(e.label==t)switch(e.value){case 1:n.form.workStatus=2;break;case 3:n.form.workStatus=4;break}})),n.form){var r=n.form.idcard,a=n.form.workStatus;Object(u["b"])(n.form,r,a).then((function(){console.log(n.form),n.$message.success("船员已离船!"),n.$router.go(0)}))}})).catch((function(){}))},backPage:function(){this.$router.go(-1)},isManager:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(h["c"])().then((function(e){return e.data.data}));case 2:this.userData=e.sent,-1===this.userData.roles.indexOf(111)&&-1===this.userData.roles.indexOf(1)||(this.manager=!0);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),save:function(){var e=this;if(this.form){var t=this.form.idcard,n=this.form.workStatus;Object(u["b"])(this.form,t,n).then((function(){console.log(e.form),e.$message.success("船员已离船!"),e.$router.go(-1)}))}}}},j=y,N=n("2877"),I=Object(N["a"])(j,r,a,!1,null,null,null);t["default"]=I.exports},"20d6":function(e,t,n){"use strict";var r=n("5ca1"),a=n("0a49")(6),o="findIndex",i=!0;o in[]&&Array(1)[o]((function(){i=!1})),r(r.P+r.F*i,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},"266e":function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"n",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"o",(function(){return w})),n.d(t,"p",(function(){return O}));var r=n("b5c6"),a="/tmlms/tybcontract";function o(e){return Object(r["a"])({url:"".concat(a,"/page"),method:"get",params:e})}function i(e){return Object(r["a"])({url:"".concat(a,"/del/").concat(e),method:"post"})}function c(e){return Object(r["a"])({url:"".concat(a,"/shipcrew/").concat(e),method:"get"})}function s(e){return Object(r["a"])({url:"/admin/dict/type/".concat(e),method:"get"})}function u(e){return Object(r["a"])({url:"".concat(a,"/save"),method:"post",data:e})}function l(e){return Object(r["a"])({url:"".concat(a,"/update"),method:"post",data:e})}function d(e){return Object(r["a"])({url:"".concat(a,"/").concat(e),method:"get"})}function p(e){return Object(r["a"])({url:"".concat(a,"/review"),method:"post",params:e})}function h(e){return Object(r["a"])({url:"".concat(a,"/cancel"),method:"post",data:e})}function m(e){return Object(r["a"])({url:"".concat(a,"/checkIdcard"),method:"get",params:{employeeIdcard:e}})}function f(e){return Object(r["a"])({url:"".concat(a,"/complant"),method:"post",params:e})}function g(e){return Object(r["a"])({url:"".concat(a,"/villagePage"),method:"get",params:e})}function b(e){return Object(r["a"])({url:"".concat(a,"/refuse"),method:"post",params:{contractId:e}})}function v(e,t){return Object(r["a"])({url:"".concat(a,"/recall"),method:"post",params:{contractId:e,status:t}})}function w(e,t){return Object(r["a"])({url:"".concat(a,"/updateImage"),method:"post",params:{contractId:e,contractImage:t}})}function O(e,t){return Object(r["a"])({url:"".concat(a,"/createImages"),method:"post",params:{contractId:e,addPhoto:t}})}},"2f9e":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("ac6a"),n("28a5"),n("a481");var r=n("b5c6");function a(e){var t=e.url,n=e.method,a=void 0===n?"post":n,i=e.data,c=void 0===i?{}:i,s=e.title,u=void 0===s?"":s;return new Promise((function(e){return Object(r["a"])({url:t,method:a,headers:{responseType:"arraybuffer"},data:c,responseType:"blob"}).then((function(t){o({title:u,response:t}).then((function(){e()}))}))}))}function o(e){var t=e.title,n=void 0===t?"":t,r=e.response,a=i(r.headers["content-disposition"].replace(/"/g,""));return new Promise((function(e){var t=r.headers,o=new Blob([r.data],{type:t["content-type"]});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,n);else{var i=document.createElement("a");i.href=window.URL.createObjectURL(o),i.download=n?"".concat(n,".").concat(a.suffix):a.filename,document.body.appendChild(i),i.style.display="none",i.click()}e()}))}function i(e){var t={},n=e.split(";");return n.forEach((function(e){var n=e.replace(/^\s+|\s+$/g,""),r=n.split("=");r[1]?t[r[0]]=r[1]:t[r[0]]=r[0]})),t.suffix=t.filename.split(".")[1],t}},3490:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return h}));n("28a5");var r=n("b5c6"),a="/tmlms/relationship";function o(e){return Object(r["a"])({url:"".concat(a,"/getPage"),method:"get",params:e})}function i(e){return Object(r["a"])({url:"".concat(a,"/countRecord"),method:"get",params:e})}function c(e){return Object(r["a"])({url:"".concat(a,"/").concat(e),method:"get"})}function s(e){return Object(r["a"])({url:"".concat(a,"/remove"),method:"post",params:e})}function u(e){return Object(r["a"])({url:"".concat(a,"/edit"),method:"post",data:e})}function l(e){return Object(r["a"])({url:"".concat(a,"/create"),method:"post",data:e})}function d(e){return Object(r["a"])({url:"".concat(a,"/getLast"),method:"get",params:e})}function p(e){return new Promise((function(t,n){Object(r["a"])({url:"",method:"post",data:e,responseType:"arraybuffer"}).then((function(e){var n=e.headers["content-disposition"].split(";")[1];n=decodeURIComponent(n.split("=")[1]);var r=new Blob([e.data]),a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=n,document.body.appendChild(a),a.style.display="none",a.click(),t()})).catch((function(){n()}))}))}function h(e){return Object(r["a"])({url:"/tmlms/statistic/relationRecordWithDays",method:"get",params:e})}},"40b8":function(e,t,n){"use strict";n("056e")},4917:function(e,t,n){"use strict";var r=n("cb7c"),a=n("9def"),o=n("0390"),i=n("5f1b");n("214f")("match",1,(function(e,t,n,c){return[function(n){var r=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=c(n,e,this);if(t.done)return t.value;var s=r(e),u=String(this);if(!s.global)return i(s,u);var l=s.unicode;s.lastIndex=0;var d,p=[],h=0;while(null!==(d=i(s,u))){var m=String(d[0]);p[h]=m,""===m&&(s.lastIndex=o(u,a(s.lastIndex),l)),h++}return 0===h?null:p}]}))},"502e":function(e,t,n){"use strict";n("8e6e"),n("ac6a"),n("456d");var r=n("ade3"),a=(n("96cf"),n("1da1")),o=n("51f4");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s={delete:"删除",shelf:"上架",submit:"提交",cancel:"撤销"};t["a"]={data:function(){return{pagedTable:[],multipleSelection:[],isLoadTable:!0,pagination:this._pageOption(),pageOption:this._pageOption(),searchForm:{}}},methods:{_pageOption:function(){return Object(o["a"])()},searchPage:function(e){this.pageOption=this._pageOption(),this.searchForm=e,this.loadPage(e)},loadTable:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r,a,o,i,s,u,l,d,p,h=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=h.length>2&&void 0!==h[2]?h[2]:function(e){return e},this.isLoadTable=!0,e.next=4,n(c(c({},this.pageOption),t));case 4:return a=e.sent,o=a.data,i=o.data,s=i.records,u=i.size,l=i.total,d=i.current,p=l/u+1===d,p&&0!==l?this.searchPage({current:d-1,size:u,total:l}):this.pagination={current:d,size:u,total:l},this.pagedTable=s.map(r),this.isLoadTable=!1,e.abrupt("return",o.data);case 12:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.pageOption.size=e,this.loadPage()},handleCurrentChange:function(e){this.pageOption.current=e,this.loadPage()},_handleGlobalDeleteById:function(e,t){this._handleGlobalById(e,t,"delete")},_handleGlobalDeleteAll:function(e){this._handleGlobalAll(e,"delete")},_handleGlobalById:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"delete",a=s[r];this.$confirm("此操作将".concat(a,"该数据, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t(e).then((function(e){e.data.data?n.$message({type:"success",message:"".concat(a,"成功!")}):n.$message({type:"info",message:"".concat(a,"失败，").concat(e.data.msg)}),n.loadPage()}))}))},_handleGlobalAll:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,i=this,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:"delete",r=this.multipleSelection,o=s[n],void 0!==r&&0!==r.length){e.next=6;break}return this.$message("请先选择需要".concat(o,"的选项")),e.abrupt("return");case 6:this.$confirm("此操作将".concat(o,"这些数据, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(a["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t(r);case 2:n=e.sent,a=n.data,a.data?(i.$message({type:"success",message:"".concat(o,"成功!")}),i.pageOption=i._pageOption()):i.$message({type:"info",message:"".concat(o,"失败，").concat(a.msg)}),i.loadPage();case 6:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),_handleComfirm:function(e,t,n,r,o){var i=this;this.$confirm(r||"是否".concat(n),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(a["a"])(regeneratorRuntime.mark((function r(){var a,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t(e);case 2:a=r.sent,c=a.data,c.data?i.$message({type:"success",message:o||"".concat(n,"成功!")}):i.$message({type:"info",message:"".concat(c.msg)}),i.loadPage();case 6:case"end":return r.stop()}}),r)})))).catch((function(e){i.$message({type:"info",message:"".concat(e,", 已取消").concat(n)})}))},mixinsCellPointerStyle:function(e){var t=e.column;return"index"!==t.type&&"selection"!==t.type&&"操作"!==t.label&&"cursor:pointer"}}}},"51f8":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.dialogVisible?n("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("edit-form",{ref:"editForm",attrs:{status:e.status,span:12,shipNameDisabled:""},on:{end:e.close},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.close}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1):e._e()},a=[],o=n("84df"),i=n("e0ea"),c={components:{editForm:i["default"]},props:{status:{type:String,default:"add"},id:String,value:Object},data:function(){return{dialogVisible:!1}},computed:{title:function(){return"add"===this.status?"新增联系记录":"detail"===this.status?"联系记录详情":"update"===this.status?"编辑联系记录":"联系记录"}},methods:{open:function(){var e=this;this.dialogVisible=!0,this.$nextTick((function(){e.id&&e.$refs.editForm.getList(e.id),"add"===e.status&&e.$set(e.$refs.editForm.form,"relationshipTime",Object(o["a"])())}))},close:function(){this.dialogVisible=!1,this.$emit("closeDialog")},handleSubmit:function(){this.$refs.editForm.handleSubmit()}}},s=c,u=n("2877"),l=Object(u["a"])(s,r,a,!1,null,null,null);t["default"]=l.exports},5612:function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return s})),n.d(t,"m",(function(){return u})),n.d(t,"r",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"t",(function(){return p})),n.d(t,"u",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"v",(function(){return b})),n.d(t,"f",(function(){return v})),n.d(t,"z",(function(){return w})),n.d(t,"k",(function(){return O})),n.d(t,"n",(function(){return y})),n.d(t,"h",(function(){return j})),n.d(t,"p",(function(){return N})),n.d(t,"x",(function(){return I})),n.d(t,"y",(function(){return x})),n.d(t,"w",(function(){return k})),n.d(t,"b",(function(){return _})),n.d(t,"q",(function(){return S})),n.d(t,"a",(function(){return P})),n.d(t,"s",(function(){return $})),n.d(t,"o",(function(){return T}));var r=n("b5c6"),a=n("2f9e"),o="/tmlms/crew";function i(e){return Object(r["a"])({url:"".concat(o,"/Page"),method:"get",params:e})}function c(e){return Object(r["a"])({url:"".concat(o,"/findByShipId?shipId=").concat(e),method:"get",params:e})}function s(e){return Object(r["a"])({url:"".concat(o,"/getHistoryByShipId?shipId=").concat(e.shipId),method:"get",params:e})}function u(e){return Object(r["a"])({url:"".concat(o,"/pageWithShip"),method:"get",params:e})}function l(e){return Object(r["a"])({url:"".concat(o,"/shipLogPage"),method:"get",params:e})}function d(e){return Object(r["a"])({url:"".concat(o,"/checkMoreRelations"),method:"post",data:e})}function p(e,t){return Object(r["a"])({url:"".concat(o,"/create?type=").concat(t),method:"post",data:e})}function h(e,t){return Object(r["a"])({url:"".concat(o,"/batchCreate?type=").concat(t),method:"post",data:e,timeout:3e5})}function m(e){return Object(r["a"])({url:"".concat(o,"/delete?idcard=").concat(e),method:"post"})}function f(e,t){return Object(r["a"])({url:"".concat(o,"/deleteRelation?idcard=").concat(e,"&&shipId=").concat(t),method:"post"})}function g(e,t){return Object(r["a"])({url:"".concat(o,"/edit?type=").concat(t),method:"post",data:e})}function b(e,t){return Object(r["a"])({url:"".concat(o,"/review?status=").concat(e,"&userId=").concat(t),method:"post"})}function v(e){return Object(r["a"])({url:"".concat(o,"/getCrewByidcard?idcard=").concat(e),method:"get"})}function w(e){return Object(r["a"])({url:"admin/file/upload/avatar",method:"post",data:e})}function O(e){return Object(r["a"])({url:"".concat(o,"/idcardcheck?idcard=").concat(e),method:"get"})}function y(e){return Object(r["a"])({url:"".concat(o,"/idcardcheck?idcard=").concat(e),method:"get"})}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"船员信息";return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downloadCrew",data:e,title:t})}function N(e){return Object(r["a"])({url:"".concat(o,"/badPage"),method:"get",params:e})}function I(e){return Object(r["a"])({url:"".concat(o,"/badUpdateBatch"),method:"post",data:e})}function x(e){return Object(r["a"])({url:"".concat(o,"/uploadBaseImage"),method:"post",data:e})}function k(e){return Object(r["a"])({url:"".concat(o,"/updateCertByIdcard"),method:"post",params:e})}function _(e){return Object(r["a"])({url:"".concat(o,"/changeShip"),method:"post",data:e})}function S(e){return Object(r["a"])({url:"".concat(o,"/getShipRelationByIdcard"),method:"get",params:e})}function P(e){return Object(r["a"])({url:"/tmlms/tybship/pageForChange",method:"get",params:e})}function $(e){return Object(r["a"])({url:"/tmlms/importTask/lookTask",method:"get",params:{taksId:e}})}function T(e){return Object(r["a"])({url:"/tmlms/crew_cert/newPage",method:"get",params:e})}},8003:function(e,t,n){"use strict";n("7f7f"),n("ac6a");var r=n("c533");t["a"]={data:function(){return{rogionList:[]}},methods:{getRogionList:function(){var e=this;return new Promise((function(t,n){Object(r["h"])(0).then((function(n){var r=n.data;0===r.code&&(e.rogionList=r.data),t()})).catch((function(){n()}))}))},getProvinceIdName:function(e){var t="";return this.rogionList.forEach((function(n){n.areaCode===e&&(t=n.name)})),t}}}},"84df":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("c1df"),a=n.n(r),o=function(){return a()().format("YYYY-MM-DD HH:mm:ss")}},"8b00":function(e,t,n){"use strict";n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"l",(function(){return g})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return b})),n.d(t,"o",(function(){return w})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"k",(function(){return u})),n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));n("4917"),n("3b2b");var r=n("0e0b"),a=[{prop:"shipName",label:"渔船名"},{prop:"shipNo",label:"渔船编号"},{prop:"shipowner",label:"持证人"},{prop:"shipownerIdcard",label:"持证人身份证"},{prop:"hullLength",label:"船长(m)"}],o=[{prop:"realName",label:"姓名"},{prop:"idcard",label:"身份证号码"},{prop:"phone",label:"联系电话"},{prop:"positionId",label:"现任职位",dictName:"tyb_resume_position",type:"dictGroup"},{prop:"workStatus",label:"用工状态"}],i=[{prop:"idcard",label:"身份证号码"},{prop:"workStatus",label:"用工状态"},{prop:"phone",label:"手机号码"},{prop:"certName",label:"职务证书"},{prop:"flag",label:"来源"},{prop:"provinceIdName",label:"籍贯"},{prop:"signStatus",label:"是否培训",type:"dict"}],c={signStatus:{0:"否",1:"是"}},s=[{prop:"employeeName",label:"姓名"},{prop:"employeeIdcard",label:"身份证号码"},{prop:"employeePhone",label:"联系电话"},{prop:"employeePosition",label:"职位",dictName:"tyb_resume_position",type:"dictGroup"},{prop:"provinceIdName",label:"籍贯"}],u=[{prop:"shipName",label:"船名号"},{prop:"realname",label:"姓名"}],l=[{prop:"realName",label:"姓名"},{prop:"idcard",label:"身份证"},{prop:"positionId",label:"职位",dictName:"tyb_resume_position",type:"dictGroup"},{prop:"phone",label:"电话"},{prop:"address",label:"地址"}],d=[{prop:"realName",label:"姓名",width:"180"},{prop:"idcard",label:"身份证",width:"230"},{prop:"certNames",label:"职务证书"},{prop:"shipNames",label:"已登记的渔船"},{prop:"leftTime",label:"最近上船时间",width:"210"}],p=[{prop:"realName",label:"姓名"},{prop:"idcard",label:"身份证"},{prop:"shipId",label:"船名"},{prop:"flag",label:"上下船类型"},{prop:"sourceType",label:"来源"},{prop:"leftTime",label:"最近上船时间"}],h=function(){return{activityType:"",address:"",buildDate:"",createTime:"",dualPower:"",engineTotalPower:"",fishType:"",fishingGear:"",grossTonnage:"",hullLength:"",hullMaterial:"",licensesFishingExpireDate:"",licensesInspectionExpireDate:"",licensesNationalExpireDate:"",licensesOwnerExpireDate:"",licensesDateExpire:"",licensesDateIssue:"",licensesFishingNo:"",licensesInspectionNo:"",licensesNationalNo:"",licensesOwnerShip:"",mainEngineModel:"",mainEnginePower:"",mobile:"",mouldedBreadth:"",mouldedDepth:"",netTonnage:"",portRegister:"",shipId:"",shipName:"",shipNo:"",shipShare:"",shipowner:"",shipownerIdcard:"",updateTime:"",userId:"",workMode:"",workMode2:"",zipcode:"",regionId:""}};function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new RegExp("^\\d{0,"+t+"}$");if(0===n)return r.test(e);var a=new RegExp("^\\d{0,"+t+"}\\.\\d{0,"+n+"}$");return r.test(e)||a.test(e)}function f(e,t,n){""===t?n(new Error):m(t,e.length,e.decimal)?n():n(new Error)}var g={regionId:[{required:!0,message:"该选项必填！",trigger:"blur"}],address:[{required:!0,message:"该选项必填！",trigger:"blur"}],createTime:[{required:!0,message:"该选项必填！",trigger:"blur"}],licensesFishingNo:[{required:!0,message:"该选项必填！",trigger:"blur"}],licensesOwnerShip:[{required:!0,message:"该选项必填！",trigger:"blur"}],mobile:[{required:!0,validator:f,trigger:"blur",length:11,decimal:0,message:"请输入正确的手机号码！"}],shipId:[{required:!0,message:"该选项必填！",trigger:"blur"}],shipName:[{required:!0,message:"该选项必填！",trigger:"blur"}],shipNo:[{required:!0,message:"该选项必填！",trigger:"blur"}],shipShare:[{required:!0,message:"该选项必填！",trigger:"change"}],shipowner:[{required:!0,message:"该选项必填！",trigger:"blur"}],shipownerIdcard:[{required:!0,trigger:"blur",max:18,min:18,decimal:0,message:"请输入正确的身份证/企业代码！"}],updateTime:[{required:!0,message:"该选项必填！",trigger:"blur"}]},b=function(){return{shipName:"",shipNo:"",shipowner:"",shipownerIdcard:""}},v=function(){return{shipName:"",shipNo:"",shipowner:"",shipownerIdcard:""}},w=function(e){var t=Object(r["g"])(v(),e);return t.shipName=e.shipName?e.shipName:null,t.shipNo=e.shipNo?e.shipNo:null,t.shipowner=e.shipowner?e.shipowner:null,t.shipownerIdcard=e.shipownerIdcard?e.shipownerIdcard:null,t};function O(e){return!e.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[0-9]|19[0-9]|16[0-9])[0-9]{8}$/)}function y(e){return!e.match(/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/)}},ade36:function(e,t,n){"use strict";n.d(t,"w",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"r",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"t",(function(){return l})),n.d(t,"v",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"J",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"s",(function(){return f})),n.d(t,"x",(function(){return g})),n.d(t,"y",(function(){return b})),n.d(t,"o",(function(){return v})),n.d(t,"u",(function(){return w})),n.d(t,"z",(function(){return O})),n.d(t,"k",(function(){return y})),n.d(t,"m",(function(){return j})),n.d(t,"l",(function(){return N})),n.d(t,"n",(function(){return I})),n.d(t,"j",(function(){return x})),n.d(t,"G",(function(){return k})),n.d(t,"H",(function(){return _})),n.d(t,"b",(function(){return S})),n.d(t,"D",(function(){return P})),n.d(t,"I",(function(){return $})),n.d(t,"C",(function(){return T})),n.d(t,"q",(function(){return R})),n.d(t,"A",(function(){return C})),n.d(t,"c",(function(){return D})),n.d(t,"B",(function(){return E})),n.d(t,"f",(function(){return B})),n.d(t,"g",(function(){return L})),n.d(t,"E",(function(){return q})),n.d(t,"a",(function(){return z})),n.d(t,"K",(function(){return M})),n.d(t,"p",(function(){return V})),n.d(t,"F",(function(){return F}));var r=n("b5c6"),a=n("2f9e"),o="/tybship/tybship";function i(e){return Object(r["a"])({url:"".concat(o,"/otherpage"),method:"get",params:e})}function c(e,t){return Object(r["a"])({url:"".concat(o,"/updateVillage?shipId=").concat(e,"&&villageId=").concat(t),method:"post"})}function s(){return Object(r["a"])({url:"/admin/org/page",method:"get"})}function u(e,t){return Object(r["a"])({url:"".concat(o,"/updateOrgId?shipId=").concat(e,"&&orgId=").concat(t),method:"post"})}function l(e){return Object(r["a"])({url:"".concat(o,"/").concat(e),method:"get",params:e})}function d(e){return Object(r["a"])({url:"".concat(o,"/").concat(e),method:"get"})}function p(e){return Object(r["a"])({url:"".concat(o,"/save"),method:"post",data:e})}function h(e){return Object(r["a"])({url:"".concat(o,"/update"),method:"post",data:e})}function m(e){return Object(r["a"])({url:"".concat(o,"/del/").concat(e),method:"post"})}function f(e){return Object(r["a"])({url:"".concat(o,"/mypage"),method:"get",params:e})}function g(e){return Object(r["a"])({url:"".concat(o,"/findship/").concat(e),method:"get"})}function b(e){return Object(r["a"])({url:"".concat(o,"/findshipWithOutOrg/").concat(e),method:"get"})}function v(e){return Object(r["a"])({url:"".concat(o,"/findmyship/").concat(e),method:"get"})}function w(e){return Object(r["a"])({url:"".concat(o,"/searchByshipNo"),method:"get",params:{shipNo:e}})}function O(e){return Object(r["a"])({url:"".concat(o,"/newpageV2"),method:"get",params:e})}function y(e){return Object(a["a"])({url:"tybship/tybshipExcelExport/downShipInfo",data:e,title:"渔船信息"})}function j(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downShipCrew",data:e,title:"开航登记表-"+e.shipName})}function N(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downShipCrewRecord",data:e,title:"实名登记备案表-"+e.shipName})}function I(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downShipCrewTwoOld ",data:e,title:"船员登记表-"+e.shipName})}function x(e){return Object(a["a"])({url:"tmlms/tybmlmsExcelExport/downContractModel",data:e,title:e.shipName})}function k(e){return Object(r["a"])({url:"tmlms/tyb_order/page",method:"get",params:e})}function _(e){return Object(r["a"])({url:"tmlms/tyb_order/getById",method:"get",params:e})}function S(e){return Object(r["a"])({url:"tmlms/tyb_order/agree",method:"post",data:e})}function P(e){return Object(r["a"])({url:"tmlms/tyb_order/reject",method:"post",data:e})}function $(e){return Object(r["a"])({url:"/tmlms/tybPortRecord/page",method:"get",params:e})}function T(e){return Object(r["a"])({url:"/tmlms/tybPortRecord/lastRecord",method:"get",params:e})}function R(e){return Object(r["a"])({url:"/tmlms/tybPortRecord/getCrewByRecordId",method:"get",params:e})}function C(e){return Object(r["a"])({url:"/tybship/tybship/info/".concat(e),method:"get"})}function D(e){return Object(r["a"])({url:"/tmlms/crew_cert/certStandard/".concat(e),method:"get"})}function E(e){return Object(r["a"])({url:"/tmlms/investigationReport/pageByShipName?shipName=".concat(e),method:"get"})}function B(e){return Object(r["a"])({url:"/tmlms/crew/countContractByShipId?shipId=".concat(e),method:"get"})}function L(e){return Object(r["a"])({url:"/tmlms/tybPortRecord/page",method:"get",params:e})}function q(e){return Object(r["a"])({url:"/tmlms/tybTroubleshootReport/pageByShipNo",method:"get",params:e})}function z(e){return Object(r["a"])({url:"/tmlms/tyb_order/pageByShipName",method:"get",params:e})}function M(e){return Object(r["a"])({url:"/tmlms/verification/page",method:"get",params:e})}function V(e){return console.log(e),Object(r["a"])({url:"/tmlms/tyb_order/getById?id=".concat(e.id),method:"get"})}function F(e){return Object(r["a"])({url:"/tmlms/tybmlmsExcelExport/downVerification",method:"post",headers:{"Content-Type":"application/json"},responseType:"arraybuffer",data:e}).then((function(e){var t=new Blob([e.data],{type:"application/vnd.ms-excel"}),n=document.createElement("a");n.href=window.URL.createObjectURL(t),n.download="实船鉴证.xls",n.click()}))}},b461:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"change-man"},[n("el-dialog",{attrs:{title:"渔船变更",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{staticClass:"ship-change"},[n("h3",[e._v("当前船员所在渔船")]),n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return n("el-option",{key:e.shipId,attrs:{label:e.shipName,value:e.shipId}})})),1)],1),n("div",[n("h3",[e._v("请选择要登入的渔船")]),n("div",[n("span",{staticStyle:{width:"120px",display:"inline-block","margin-right":"20px"}},[n("el-input",{attrs:{placeholder:"渔船名",size:"small",clearable:""},model:{value:e.params.shipName,callback:function(t){e.$set(e.params,"shipName","string"===typeof t?t.trim():t)},expression:"params.shipName"}})],1),n("el-button",{attrs:{size:"small"},on:{click:function(t){return e.getData()}}},[e._v("搜索")])],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{prop:"shipName",label:"渔船名"}}),n("el-table-column",{attrs:{prop:"shipNo",label:"渔船编号"}}),n("el-table-column",{attrs:{prop:"shipowner",label:"持证人"}}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"small"},on:{click:function(n){return e.handleClick(t.row)}}},[e._v("选择")])]}}])})],1),n("div",{staticStyle:{"text-align":"center",margin:"20px 0"}},[n("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper",total:e.page.total,"page-size":e.page.size,"current-page":e.page.current},on:{"update:currentPage":function(t){return e.$set(e.page,"current",t)},"update:current-page":function(t){return e.$set(e.page,"current",t)},"size-change":e.handleSizeChange,"current-change":e.currentChange}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)])],1)},a=[],o=(n("8e6e"),n("ac6a"),n("456d"),n("ade3")),i=n("5612");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={mixins:[],data:function(){return{options:[],dialogVisible:!1,value:"",tableData:[],page:{total:0,size:10,current:1},idcard:"",params:{}}},methods:{getData:function(){var e=this;Object(i["a"])(s(s({},this.params),{},{current:this.page.current})).then((function(t){e.tableData=t.data.data.records,e.page=t.data.data}))},getOption:function(e){var t=this;this.idcard=e,Object(i["q"])({idcard:e}).then((function(e){t.options=e.data.data,0!==t.options.length&&(t.value=e.data.data[0].shipId)}))},handleSizeChange:function(e){this.page.size=e,this.page.current=1,this.getData()},currentChange:function(e){this.page.current=e,this.getData()},handleClick:function(e){var t=this;if(0!==this.options.length&&!this.value)return this.$message.warning("请先选择登出渔船!"),!1;this.$confirm("确认将此船员更改为".concat(e.shipName,"?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["b"])({shipId:t.value,changeShipId:e.shipId,idcard:t.idcard}).then((function(){t.$message.success("操作成功!"),t.dialogVisible=!1,t.$emit("back")}))}))}},computed:{},created:function(){this.getData()},filters:{}},l=u,d=(n("40b8"),n("2877")),p=Object(d["a"])(l,r,a,!1,null,"9e6b8296",null);t["default"]=p.exports},c533:function(e,t,n){"use strict";n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"b",(function(){return g}));var r=n("b5c6"),a="tmlms/crew",o="admin/region",i="admin/dict";function c(e){return Object(r["a"])({url:"".concat(o,"/getinfo/")+e,method:"get"})}function s(e){return Object(r["a"])({url:"".concat(i,"/type/")+e,method:"get"})}function u(e){return Object(r["a"])({url:"".concat(o,"/area"),method:"get",params:{parentCode:e}})}function l(e){return Object(r["a"])({url:"".concat(a,"/Page"),method:"get",params:e})}function d(e){return Object(r["a"])({url:"".concat(a,"/delete"),method:"post",params:{userId:e}})}function p(e){return Object(r["a"])({url:"".concat(a,"/create"),method:"post",data:e,params:{type:1}})}function h(e){return Object(r["a"])({url:"".concat(a,"/getCrewByUserId"),method:"get",params:{userId:e}})}function m(e){return Object(r["a"])({url:"".concat(a,"/edit"),method:"post",params:{type:1},data:e})}function f(e){return Object(r["a"])({url:"/tybship/tybregion/parent/".concat(e),method:"get"})}function g(e,t,n){return Object(r["a"])({url:"".concat(a,"/upWork?idcard=").concat(t,"&workStatus=").concat(n),method:"post",data:e})}},cec6:function(e,t,n){"use strict";t["a"]={relationshipReason:[{label:"A",value:"1"},{label:"B",value:"2"}],relationshipType:[{label:"手机",value:1},{label:"座机",value:2},{label:"微信",value:3},{label:"其他",value:4}]}},e0ea:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"150px",disabled:"detail"===e.status}},[n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"渔船名",prop:"shipName"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",remote:"",disabled:e.shipNameDisabled,maxlength:"20","remote-method":e.getShipNameList},on:{change:e.onChange},model:{value:e.form.shipName,callback:function(t){e.$set(e.form,"shipName",t)},expression:"form.shipName"}},e._l(e.shipNames,(function(e){return n("el-option",{key:e.shipId,attrs:{label:e.shipName,value:e.shipName}})})),1)],1)],1),n("el-col",{attrs:{span:e.span}},[n("el-form-item",{attrs:{label:"联系人",prop:"shipownerName"}},[n("el-input",{model:{value:e.form.shipownerName,callback:function(t){e.$set(e.form,"shipownerName","string"===typeof t?t.trim():t)},expression:"form.shipownerName"}})],1)],1),n("el-col",{attrs:{span:e.span}},[n("el-form-item",{attrs:{label:"手机号",prop:"shipownerPhone"}},[n("el-input",{attrs:{type:"number"},model:{value:e.form.shipownerPhone,callback:function(t){e.$set(e.form,"shipownerPhone","string"===typeof t?t.trim():t)},expression:"form.shipownerPhone"}})],1)],1),n("el-col",{attrs:{span:e.span}},[n("el-form-item",{attrs:{label:"联系设备",prop:"relationshipType"}},[n("el-select",{attrs:{placeholder:""},model:{value:e.form.relationshipType,callback:function(t){e.$set(e.form,"relationshipType",t)},expression:"form.relationshipType"}},e._l(e.map.relationshipType,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),n("el-col",{attrs:{span:e.span}},[3!==e.form.relationshipType?n("el-form-item",{attrs:{label:"联系号码",prop:"relationshipNumber"}},[n("el-input",{model:{value:e.form.relationshipNumber,callback:function(t){e.$set(e.form,"relationshipNumber","string"===typeof t?t.trim():t)},expression:"form.relationshipNumber"}})],1):e._e()],1),n("el-col",{attrs:{span:e.span}},[n("el-form-item",{attrs:{label:"联系事由",prop:"relationshipReason"}},[n("el-input",{attrs:{maxlength:"50"},model:{value:e.form.relationshipReason,callback:function(t){e.$set(e.form,"relationshipReason","string"===typeof t?t.trim():t)},expression:"form.relationshipReason"}})],1)],1),n("el-col",{attrs:{span:e.span}},[n("el-form-item",{attrs:{label:"联系时间",prop:"relationshipTime"}},[n("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"",align:"right"},model:{value:e.form.relationshipTime,callback:function(t){e.$set(e.form,"relationshipTime",t)},expression:"form.relationshipTime"}})],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"附件"}},[n("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/admin/file/upload/avatar","on-success":e.handleSuccess,"on-remove":e.handleRemove,"before-upload":e.handleBeforeUpload,"file-list":e.fileList,"on-preview":e.handlePictureCardPreview,multiple:"",headers:e.headers,"list-type":"picture-card"}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s("只能上传图片文件，且不超过4M"))])],1)],1)],1)],1),n("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":"",width:"820px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{staticStyle:{"text-align":"center"}},[n("img",{staticStyle:{"max-width":"780px"},attrs:{src:e.dialogImageUrl,alt:""}})])])],1)},a=[],o=(n("8e6e"),n("456d"),n("96cf"),n("1da1")),i=(n("20d6"),n("ac6a"),n("ade3")),c=(n("c5f6"),n("3490")),s=n("ade36"),u=n("2f62"),l=n("0644"),d=n.n(l),p=n("cec6");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f={props:{status:String,value:{type:Object,default:function(){return{shipName:""}}},span:{type:Number,dafault:24},shipNameDisabled:{type:Boolean,dafault:!1}},data:function(){return{dialogImageUrl:"",dialogVisible:!1,map:p["a"],form:{shipownerName:"",shipownerPhone:"",relationshipType:"",files:[]},fileList:[],shipNames:[],pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}}]},rules:{shipName:[{required:!0,message:"请输入渔船名",trigger:["change","blur"]}],shipownerName:[{required:!0,message:"请输入联系人",trigger:"blur"}],shipownerPhone:[{required:!0,message:"请输入手机号",trigger:"blur"}],relationshipType:[{required:!0,message:"请选择联系设备",trigger:"change"}],relationshipNumber:[{required:!0,message:"请输入联系号码",trigger:"blur"}],relationshipReason:[{required:!0,message:"请选择联系事由",trigger:"blur"}],relationshipTime:[{required:!0,message:"请选择联系时间",trigger:"change"}]}}},computed:m(m({},Object(u["c"])(["dictGroup","access_token"])),{},{headers:function(){return{Authorization:"Bearer "+this.access_token}}}),watch:{"form.relationshipType":{handler:function(e){this.getShipNameLastInfo(),3===e&&(this.form.relationshipNumber="")}},"form.shipName":{handler:function(){this.getShipNameLastInfo()}},value:{handler:function(e){this.form.shipName=e.shipName||"",this.form.shipownerName=e.shipownerName||"",this.form.shipownerPhone=e.shipownerPhone||"",this.getShipNameLastInfo()},deep:!0,immediate:!0}},methods:{handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSuccess:function(e,t,n){var r=d()(this.form.files);Array.isArray(this.form.files)||(this.form.files=[]),n.forEach((function(e){var t={name:"",url:e.response?e.response.data.url:""};""!==t.url&&-1===r.findIndex((function(e){return e.url===t.url}))&&r.push(t)})),this.form.files=r},handleRemove:function(e){var t=e.url,n=this.form.files.findIndex((function(e){return e.url===t}));n>-1&&this.form.files.splice(n,1)},handleBeforeUpload:function(e){var t=e.size/1024/1024<4;return t||this.$message.error("上传图片大小不能超过4MB"),t},getShipNameLastInfo:function(){var e=this;this.form.shipName&&this.form.relationshipType&&"detail"!==this.status&&Object(c["f"])({shipName:this.form.shipName,relationshipType:this.form.relationshipType}).then((function(t){var n=t.data;0===n.code&&n.data&&e.form.relationshipType===n.data.relationshipType&&e.$set(e.form,"relationshipNumber",n.data.relationshipNumber)}))},getShipNameList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(5!==t.length){e.next=12;break}return e.prev=1,e.next=4,Object(s["x"])(t);case 4:n=e.sent,r=n.data,0===r.code&&(this.shipNames=r.data),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),this.$message({message:e.t0||"数据查询失败",type:"warning"});case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(t){return e.apply(this,arguments)}return t}(),onChange:function(e){var t=this.shipNames.filter((function(t){return t.shipName===e}));console.log("data",t,e),t&&t.length>0?(this.$set(this.form,"shipownerName",t[0].shipowner),this.$set(this.form,"shipownerPhone",t[0].mobile),console.log("this.form",this.form)):(this.form.shipownerName="",this.form.shipownerPhone="")},getList:function(e){var t=this;Object(c["e"])(e).then((function(e){var n=e.data;if(0===n.code){var r=n.data,a=[];null==r.relationshipImages&&(r.relationshipImages=[]),r.relationshipImages.forEach((function(e){var t={name:"",url:e};a.push(t)})),t.fileList=a,r.files=a,t.form=r,console.log("result",r)}}))},handleSubmit:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(t){var n="add"===e.status?c["a"]:"update"===e.status?c["i"]:null;n&&(e.form.relationshipImages=e.form.files.map((function(e){return e.url}))||[],n(e.form).then((function(t){var n=t.data;0===n.code&&(e.$notify({message:"add"===e.status?"新增成功":"编辑成功",type:"success"}),e.$emit("end"))})))}}))}}},g=f,b=n("2877"),v=Object(b["a"])(g,r,a,!1,null,"9e767f86",null);t["default"]=v.exports}}]);