(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34796b6c"],{"27aea":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contract-box"},[a("basic-container",[a("h1",[e._v(e._s(e.$route.query.see?"查看":e.$route.query.edit?"编辑":"新增")+"船东信息")]),a("el-form",{ref:"form",attrs:{model:e.shipowner,"label-width":"150px",rules:e.rules}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"姓名:",prop:"realName"}},[e.$route.query.see?a("div",[e._v(e._s(e.shipowner.realName))]):a("el-select",{attrs:{placeholder:"请选择渔船名"},on:{change:e.realNameChange},model:{value:e.shipowner.realName,callback:function(t){e.$set(e.shipowner,"realName",t)},expression:"shipowner.realName"}},e._l(e.realNameList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"身份证号:",prop:"idcard"}},[e.$route.query.see?a("div",[e._v(e._s(e.shipowner.idcard))]):a("el-input",{attrs:{placeholder:"",disabled:e.haveInfo.idcard},model:{value:e.shipowner.idcard,callback:function(t){e.$set(e.shipowner,"idcard",t)},expression:"shipowner.idcard"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"联系地址:",prop:"address"}},[e.$route.query.see?a("div",[e._v(e._s(e.shipowner.address))]):a("el-input",{attrs:{placeholder:""},model:{value:e.shipowner.address,callback:function(t){e.$set(e.shipowner,"address",t)},expression:"shipowner.address"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"手机号码:",prop:"phone"}},[e.$route.query.see?a("div",[e._v(e._s(e.shipowner.phone))]):a("el-input",{attrs:{placeholder:"",disabled:e.haveInfo.phone,readonly:e.isReadonly},model:{value:e.shipowner.phone,callback:function(t){e.$set(e.shipowner,"phone",t)},expression:"shipowner.phone"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属行政村：",prop:"regionId"}},[e.$route.query.see?a("div",[e._v(e._s(e.shipowner.regionId))]):a("el-cascader",{attrs:{options:e.options,props:e.props},on:{"active-item-change":e.handleItemChange},model:{value:e.shipowner.regionId,callback:function(t){e.$set(e.shipowner,"regionId",t)},expression:"shipowner.regionId"}})],1)],1)],1)],1),a("div",{staticStyle:{"text-align":"center"}},[e.$route.query.see?e._e():a("el-button",{on:{click:e.save}},[e._v("提交")]),a("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),e.manager?a("el-button",{on:{click:e.collect}},[e._v("数据读取")]):e._e()],1)],1)],1)},_=[],n=a("de0d"),i=n["a"],o=(a("abd2"),a("2877")),s=Object(o["a"])(i,r,_,!1,null,"6a04adb2",null);t["default"]=s.exports},"2f9e":function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));a("ac6a"),a("28a5"),a("a481");var r=a("b5c6");function _(e){var t=e.url,a=e.method,_=void 0===a?"post":a,i=e.data,o=void 0===i?{}:i,s=e.title,c=void 0===s?"":s;return console.log(t),new Promise((function(e){return Object(r["a"])({url:t,method:_,headers:{responseType:"arraybuffer"},data:o,responseType:"blob"}).then((function(t){n({title:c,response:t}).then((function(){e()}))}))}))}function n(e){var t=e.title,a=void 0===t?"":t,r=e.response,_=i(r.headers["content-disposition"].replace(/"/g,""));return new Promise((function(e){var t=r.headers,n=new Blob([r.data],{type:t["content-type"]});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,a);else{var i=document.createElement("a");i.href=window.URL.createObjectURL(n),i.download=a?"".concat(a,".").concat(_.suffix):_.filename,document.body.appendChild(i),i.style.display="none",i.click()}e()}))}function i(e){var t={},a=e.split(";");return a.forEach((function(e){var a=e.replace(/^\s+|\s+$/g,""),r=a.split("=");r[1]?t[r[0]]=r[1]:t[r[0]]=r[0]})),t.suffix=t.filename.split(".")[1],t}},4917:function(e,t,a){"use strict";var r=a("cb7c"),_=a("9def"),n=a("0390"),i=a("5f1b");a("214f")("match",1,(function(e,t,a,o){return[function(a){var r=e(this),_=void 0==a?void 0:a[t];return void 0!==_?_.call(a,r):new RegExp(a)[t](String(r))},function(e){var t=o(a,e,this);if(t.done)return t.value;var s=r(e),c=String(this);if(!s.global)return i(s,c);var d=s.unicode;s.lastIndex=0;var u,l=[],h=0;while(null!==(u=i(s,c))){var p=String(u[0]);l[h]=p,""===p&&(s.lastIndex=n(c,_(s.lastIndex),d)),h++}return 0===h?null:l}]}))},"5a4a":function(e,t,a){},"6c21":function(e,t,a){"use strict";a.d(t,"g",(function(){return i})),a.d(t,"j",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"h",(function(){return c})),a.d(t,"d",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"e",(function(){return l})),a.d(t,"k",(function(){return h})),a.d(t,"l",(function(){return p})),a.d(t,"f",(function(){return f})),a.d(t,"i",(function(){return m})),a.d(t,"c",(function(){return E}));var r=a("b5c6"),_=a("2f9e"),n="/tmlms/ship_owner";function i(e){return Object(r["a"])({url:"".concat(n,"/page"),method:"get",params:e})}function o(e,t){return Object(r["a"])({url:"".concat(n,"/create?type=").concat(t),method:"post",data:e})}function s(e){return Object(r["a"])({url:"".concat(n,"/delete?idcard=").concat(e),method:"post"})}function c(e){return Object(r["a"])({url:"".concat(n,"/getDetail?idcard=").concat(e),method:"get"})}function d(e){return Object(r["a"])({url:"admin/region/wholeInfoList?areaCode=".concat(e),method:"get"})}function u(e,t){return Object(r["a"])({url:"".concat(n,"/edit?type=").concat(t),method:"post",data:e})}function l(e){return Object(r["a"])({url:"admin/region/wholeInfo?areaCode=".concat(e),method:"get"})}function h(e,t){return Object(r["a"])({url:"".concat(n,"/newReview?status=").concat(e,"&idcard=").concat(t),method:"post"})}function p(e){return Object(r["a"])({url:"admin/file/upload/avatar",method:"post",data:e})}function f(e){return Object(r["a"])({url:"".concat(n,"/idcardcheck"),method:"get",params:{idcard:e}})}function m(e,t){return Object(r["a"])({url:"".concat(n,"/newedit?type=").concat(t),method:"post",data:e})}function E(e){return Object(_["a"])({url:"tmlms/tybmlmsExcelExport/downloadOwner",data:e,title:"船东信息"})}},abd2:function(e,t,a){"use strict";a("5a4a")},b440:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("b5c6"),_="/tybhrms/databuspayload";function n(e){return Object(r["a"])({url:"".concat(_,"/getlast"),method:"get",params:e})}},da1c:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return c}));var r=a("b5c6"),_="/tmlms/tybvillageshipinfo";function n(e){return Object(r["a"])({url:"".concat(_,"/getbyuser/").concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"".concat(_,"/batchship"),method:"post",data:e})}function o(e,t){return Object(r["a"])({url:"".concat(_,"/batchedit?userId=").concat(t),method:"post",data:e})}function s(e){return Object(r["a"])({url:"".concat(_,"/").concat(e),method:"get"})}function c(e){return Object(r["a"])({url:"".concat(_,"/getbyShipowner"),method:"get",params:{shipowner:e}})}},de0d:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("6762"),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("2fdb"),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_2__),E_taoyuba_ui_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("53ca"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("7f7f"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("4917"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_6__),_api_post_address__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("23d6"),_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("6c21"),_api_login__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("7ded"),_api_hrms_databuspayload__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("b440"),_api_tmlms_bvillage_villageship__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("da1c"),vue__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("2b0e"),_mixins_information__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("e420"),vue_socket_io__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("5132"),vue_socket_io__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(vue_socket_io__WEBPACK_IMPORTED_MODULE_14__),lodash_debounce__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("b047"),lodash_debounce__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(lodash_debounce__WEBPACK_IMPORTED_MODULE_15__);vue__WEBPACK_IMPORTED_MODULE_12__["default"].use(new vue_socket_io__WEBPACK_IMPORTED_MODULE_14___default.a({debug:!0,connection:"http://localhost:5000"})),__webpack_exports__["a"]={mixins:[_mixins_information__WEBPACK_IMPORTED_MODULE_13__["a"]],data:function(){this.getidcardList=lodash_debounce__WEBPACK_IMPORTED_MODULE_15___default()(this.getidcardList,800);var e=function(e,t,a){""===t?a(new Error("请输入身份证号")):t.match(/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/)?a():a(new Error("请输入正确的身份证号码!"))},t=function(e,t,a){""===t?a(new Error("请输入联系电话")):t.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/)?a():a(new Error("请输入正确的手机号码!"))};return{haveInfo:{phone:!1},certificateColumns:[{prop:"shipName",label:"渔船名"},{prop:"shipNo",label:"渔船编号"},{prop:"licensesFishingNo",label:"捕捞许可证编号"},{prop:"licensesOwnerShip",label:"渔船所有权登记证书"},{prop:"licensesNationalNo",label:"国籍证书编号"},{prop:"licensesInspectionNo",label:"船舶检验证书编号"}],shipowner:{shiplist:[],address:"",idcard:"",realName:"",phone:"",regionId:""},rules:{realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],idcard:[{required:!0,message:"请输入身份证号",trigger:"blur"},{validator:e,trigger:"blur"}],address:[{required:!0,message:"请输入联系地址",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:t,trigger:"blur"}],regionId:[{required:!0,message:"请输入所属行政村",trigger:"blur"}]},options:[],props:{value:"areaCode",label:"name",children:"childList"},arr:[],sn:"",manager:!1,idcards:[],loading:!1,isReadonly:!1,realNameList:[],cId:""}},methods:{save:function(){var e=this;this.$refs["form"].validate((function(t){if(e.shipowner.regionId&&(e.shipowner.regionId=e.shipowner.regionId[e.shipowner.regionId.length-1]),t){var a=JSON.parse(JSON.stringify(e.shipowner)),r="";r=e.manager?1:3,e.$route.query.edit?Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["b"])(a,r).then((function(t){e.$message({message:t.data.msg,type:"success"}),e.$router.go(-1)})).catch((function(t){e.$message.error(t.message)})):Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["j"])(a,r).then((function(t){e.$message({message:t.data.msg,type:"success"}),e.$router.go(-1)})).catch((function(t){e.$message.error(t.message)}))}}))},handleItemChange:function(e){var t=this;Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["c"])(e[e.length-1]).then((function(a){var r=a.data.data;t.getNode(t.options,e[e.length-1],r)}))},getNode:function(e,t,a){var r=this;e.forEach((function(e){e.areaCode==t?(e.childList=a,e.level<3&&e.childList.forEach((function(e){void 0===e.childList&&r.$set(e,"childList",[])}))):e.childList&&0!==e.childList.length&&r.getNode(e.childList,t,a)}))},setData:function(e){this.shipowner.shiplist=e},getarr:function(e){this.$route.query.edit?(this.arr.push(e.areaCode),e.child&&this.getarr(e.child)):this.$route.query.see&&(this.arr instanceof Array&&(this.arr=""),this.arr="".concat(this.arr).concat(this.arr?"/":"").concat(e.name),e.child&&this.getarr(e.child))},collect:function(){var e=this;this.sn="",Object(_api_hrms_databuspayload__WEBPACK_IMPORTED_MODULE_10__["a"])({sn:this.sn}).then((function(t){e.shipowner.address=t.data.data.address,e.shipowner.idcard=t.data.data.identityNumber,e.shipowner.realName=t.data.data.name}))},idcardChange:function(e){"object"===Object(E_taoyuba_ui_node_modules_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_3__["a"])(e)?this.refreshCard(e):this.refreshCard({idcard:e}),this.idcards=[]},refreshCard:function(e){if(null!==e){var t=e.idcard,a=void 0===t?"":t,r=e.phone,_=void 0===r?"":r;this.shipowner.phone=_,this.shipowner.idcard=a,this.isReadonly=""!==_}else this.shipowner.phone="",this.shipowner.idcard="",this.isReadonly=!1},getidcardList:function(e){var t=this;this.loading=!0,this.isReadonly=!1,""!==e?Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["f"])(e).then((function(e){var a=e.data;!0!==a.data&&t.idcards.push(a.data)})):this.idcards=[],this.loading=!1},getrealNameList:function(){var e=this;Object(_api_login__WEBPACK_IMPORTED_MODULE_9__["c"])().then((function(t){e.userId=t.data.data.sysUser.userId,Object(_api_tmlms_bvillage_villageship__WEBPACK_IMPORTED_MODULE_11__["e"])(e.userId).then((function(t){e.realNameList=t.data.data.map((function(e){return{label:e.shipowner,value:e.shipowner}}))}))}))},realNameChange:function(e){var t=this;Object(_api_tmlms_bvillage_villageship__WEBPACK_IMPORTED_MODULE_11__["d"])(e).then((function(e){t.shipowner.phone=e.data.data.mobile}))},getData:function(){var e=this;this.$route.query.edit&&(this.cId=this.$route.query.edit),this.$route.query.see&&(this.cId=this.$route.query.see),(this.$route.query.edit||this.$route.query.see)&&Object(_api_tmlms_shipowner__WEBPACK_IMPORTED_MODULE_8__["h"])(this.cId).then((function(t){0===t.data.code&&(0!==t.data.data.regionId&&Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["a"])(t.data.data.regionId).then((function(t){e.options=t.data.data})),0===t.data.data.regionId?(e.shipowner=t.data.data,Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["c"])(0).then((function(t){e.options=t.data.data,e.options.forEach((function(t){e.$set(t,"childList",[])}))})),e.shipowner.regionId=e.options,e.$route.query.see&&(e.typeList.forEach((function(t){e.shipowner.regionType===t.value&&(e.shipowner.regionType=t.label)})),e.shipowner.regionId="")):Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["b"])(t.data.data.regionId).then((function(a){e.getarr(a.data.data,e.arr),t.data.data.regionId=e.arr,e.shipowner=t.data.data,e.$route.query.see&&(e.typeList.forEach((function(t){e.shipowner.regionType===t.value&&(e.shipowner.regionType=t.label)})),e.shipowner.regionId.forEach((function(t){e.shipowner.regionId="",Object(_api_post_address__WEBPACK_IMPORTED_MODULE_7__["d"])(t).then((function(t){e.shipowner.regionId+=t.data.data.name}))})))})))}))}},computed:{},created:function(){var e=this;(this.$route.query.see||this.$route.query.edit)&&this.getData(),Object(_api_login__WEBPACK_IMPORTED_MODULE_9__["c"])().then((function(t){t.data.data.roles.includes(111)?e.manager=!0:e.manager=!1,t.data.data.sysUser.userId})),this.getrealNameList()},beforeDestroy:function(){this.sockets.unsubscribe("card message")},mounted:function mounted(){var _this10=this;function Base64(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.decode=function(a){var r,_,n,i,o,s,c,d="",u=0;a=a.replace(/[^A-Za-z0-9+/=]/g,"");while(u<a.length)i=e.indexOf(a.charAt(u++)),o=e.indexOf(a.charAt(u++)),s=e.indexOf(a.charAt(u++)),c=e.indexOf(a.charAt(u++)),r=i<<2|o>>4,_=(15&o)<<4|s>>2,n=(3&s)<<6|c,d+=String.fromCharCode(r),64!=s&&(d+=String.fromCharCode(_)),64!=c&&(d+=String.fromCharCode(n));return d=t(d),d};var t=function(e){var t="",a=0,r=0,_=0,n=0;while(a<e.length)r=e.charCodeAt(a),r<128?(t+=String.fromCharCode(r),a++):r>191&&r<224?(_=e.charCodeAt(a+1),t+=String.fromCharCode((31&r)<<6|63&_),a+=2):(_=e.charCodeAt(a+1),n=e.charCodeAt(a+2),t+=String.fromCharCode((15&r)<<12|(63&_)<<6|63&n),a+=3);return t}}this.$socket.emit("connect"),this.$socket.emit("startRead"),this.sockets.subscribe("card message",(function(msg){var base=new Base64,result1=base.decode(msg),data=eval("("+result1+")");_this10.$set(_this10.shipowner,"realName",data.name),_this10.$set(_this10.shipowner,"idcard",data.cardno),_this10.$set(_this10.shipowner,"address",data.address)}))}}},e420:function(e,t,a){"use strict";a("7f7f");var r=a("7ded");t["a"]={data:function(){return{haveInfo:{}}},methods:{getInformation:function(e,t){var a=this;Object(r["c"])().then((function(r){-1===r.data.data.roles.indexOf(1)&&-1===r.data.data.roles.indexOf(111)&&(r.data.data.sysUser.phone&&(a.$set(a.haveInfo,"phone",!0),a[e][t[0]]=r.data.data.sysUser.phone),r.data.data.sysUser.realName&&(a.$set(a.haveInfo,"realName",!0),a[e][t[1]]=r.data.data.sysUser.realName),r.data.data.sysUser.idCard&&[t[2]]&&(a.$set(a.haveInfo,"idcard",!0),a[e].idcard=r.data.data.sysUser.idCard))}))}}}}}]);