(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b104e954"],{1447:function(t,e,n){},"266e":function(t,e,n){"use strict";n.d(e,"g",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"e",function(){return i}),n.d(e,"h",function(){return u}),n.d(e,"a",function(){return s}),n.d(e,"n",function(){return l}),n.d(e,"f",function(){return d}),n.d(e,"m",function(){return f}),n.d(e,"b",function(){return m}),n.d(e,"j",function(){return p}),n.d(e,"c",function(){return h}),n.d(e,"i",function(){return b}),n.d(e,"l",function(){return g}),n.d(e,"k",function(){return v}),n.d(e,"o",function(){return j}),n.d(e,"p",function(){return O});var c=n("b5c6"),a="/tmlms/tybcontract";function r(t){return Object(c["a"])({url:"".concat(a,"/page"),method:"get",params:t})}function o(t){return Object(c["a"])({url:"".concat(a,"/del/").concat(t),method:"post"})}function i(t){return Object(c["a"])({url:"".concat(a,"/shipcrew/").concat(t),method:"get"})}function u(t){return Object(c["a"])({url:"/admin/dict/type/".concat(t),method:"get"})}function s(t){return Object(c["a"])({url:"".concat(a,"/save"),method:"post",data:t})}function l(t){return Object(c["a"])({url:"".concat(a,"/update"),method:"post",data:t})}function d(t){return Object(c["a"])({url:"".concat(a,"/").concat(t),method:"get"})}function f(t){return Object(c["a"])({url:"".concat(a,"/review"),method:"post",params:t})}function m(t){return Object(c["a"])({url:"".concat(a,"/cancel"),method:"post",data:t})}function p(t){return Object(c["a"])({url:"".concat(a,"/checkIdcard"),method:"get",params:{employeeIdcard:t}})}function h(t){return Object(c["a"])({url:"".concat(a,"/complant"),method:"post",params:t})}function b(t){return Object(c["a"])({url:"".concat(a,"/villagePage"),method:"get",params:t})}function g(t){return Object(c["a"])({url:"".concat(a,"/refuse"),method:"post",params:{contractId:t}})}function v(t,e){return Object(c["a"])({url:"".concat(a,"/recall"),method:"post",params:{contractId:t,status:e}})}function j(t,e){return Object(c["a"])({url:"".concat(a,"/updateImage"),method:"post",params:{contractId:t,contractImage:e}})}function O(t,e){return Object(c["a"])({url:"".concat(a,"/createImages"),method:"post",params:{contractId:t,addPhoto:e}})}},"304f":function(t,e,n){},"701c":function(t,e,n){"use strict";n.r(e);var c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"contract-box"},[n("basic-container",[n("page-header",{attrs:{title:"投诉管理"}}),n("operation-container",[n("template",{slot:"right"},[n("iep-button",{attrs:{plain:""},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1)],2),n("avue-tree-table",{staticStyle:{"margin-top":"20px"},attrs:{option:t.options}},[n("el-table-column",{attrs:{label:"图片证据上传"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{staticStyle:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},attrs:{src:t.row.image}})]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return["投诉"===e.row.type&&"待通过"===e.row.status?n("el-button",{attrs:{type:"text",icon:"el-icon-edit",size:"mini"},on:{click:function(n){return t.complain(e.row.contractId,e.row.id)}}},[t._v("是否同意投诉")]):t._e()]}}])})],1),n("div",{staticStyle:{"text-align":"center",margin:"20px 0"}},[n("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:t.total,"page-size":t.params.size},on:{"current-change":t.currentChange}})],1),n("el-dialog",{attrs:{title:"提示",visible:t.comDialog,width:"30%","before-close":t.comClose},on:{"update:visible":function(e){t.comDialog=e}}},[n("span",[t._v("是否同意投诉")]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.agreeComplain}},[t._v("同 意")]),n("el-button",{attrs:{type:"primary"},on:{click:t.cancelComplain}},[t._v("拒 绝")])],1)])],1)],1)},a=[],r=(n("96cf"),n("3b8d")),o=(n("ac6a"),n("266e")),i=n("e1ca"),u=n("e17e"),s={name:"relieve",data:function(){return{contractList:[],params:{current:1,size:10},total:0,contType:[{id:1,label:"解除合同"},{id:2,label:"投诉"}],contStatus:[{id:0,label:"待通过"},{id:1,label:"通过"},{id:2,label:"不通过"}],i:"",cd:"",comDialog:!1,cont:""}},created:function(){this.getContractList()},computed:{options:function(){return{expandAll:!1,columns:[{text:"合同号",value:"contractId"},{text:"发起人",value:"userId"},{text:"接受人",value:"receiverId"},{text:"解除或投诉原因",value:"content"},{text:"合同类型",value:"type"},{text:"合同状态",value:"status"}],data:this.contractList}}},methods:{getContractList:function(){var t=this;this.params.contractId=this.$route.params.contractId,Object(i["c"])(this.params).then(function(e){var n=e.data;0===n.code&&(t.contractList=n.data.records,t.contractList.forEach(function(e){Object(u["d"])(e.userId).then(function(t){e.userId=t.data.data.realName}),Object(u["d"])(e.receiverId).then(function(t){e.receiverId=t.data.data.realName}),t.contStatus.forEach(function(t){e.status===t.id&&(e.status=t.label)}),t.contType.forEach(function(t){e.type===t.id&&(e.type=t.label)})}),t.total=n.data.total)},function(e){t.$message.error(e.message)})},currentChange:function(t){this.params.current=t,this.getContractList()},complain:function(t,e){this.comDialog=!0,this.cd=t,this.i=e},comClose:function(){this.comDialog=!1},agreeComplain:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["f"])(this.cd).then(function(t){return t.data.data.status});case 2:this.cont=t.sent,3===this.cont?Object(o["c"])({cancelId:this.i}).then(function(){e.$message.success("同意投诉成功！"),e.getContractList(),e.comDialog=!1}).catch(function(){e.$message.error("同意投诉失败！")}):this.$message.error("合同状态不正确，需要管理员审核！");case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),cancelComplain:function(){var t=this;Object(i["b"])(this.i).then(function(){t.$message.success("已拒绝投诉申请"),t.getContractList(),t.comDialog=!1}).catch(function(){t.$message.error("拒绝投诉失败！"),t.getContractList(),t.comDialog=!1})}}},l=s,d=(n("e8b7"),n("e5d9"),n("0c7c")),f=Object(d["a"])(l,c,a,!1,null,"c46df6ac",null);e["default"]=f.exports},e1ca:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"c",function(){return o}),n.d(e,"b",function(){return i});var c=n("b5c6"),a="/tmlms/tybcontractcancel";function r(t){return Object(c["a"])({url:"".concat(a,"/save"),method:"post",data:t})}function o(t){return Object(c["a"])({url:"".concat(a,"/newpage"),method:"get",params:t})}function i(t){return Object(c["a"])({url:"".concat(a,"/review"),method:"post",params:{cancelId:t}})}},e5d9:function(t,e,n){"use strict";var c=n("1447"),a=n.n(c);a.a},e8b7:function(t,e,n){"use strict";var c=n("304f"),a=n.n(c);a.a}}]);