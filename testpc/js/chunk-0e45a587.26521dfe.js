(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e45a587"],{"7b0b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contract-box"},[a("basic-container",[a("div",{staticClass:"shipowner_title"},[a("page-header",{attrs:{title:"教材订单"}}),a("div",{staticClass:"shipowner_title"},[a("iep-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",plain:""},on:{click:e.handleAdd}},[e._v("新增")]),a("div",{staticStyle:{float:"right"}},[a("span",{staticStyle:{width:"120px"}},[a("el-input",{attrs:{placeholder:"单位",size:"mini",clearable:""},model:{value:e.params.department,callback:function(t){e.$set(e.params,"department",t)},expression:"params.department"}})],1),a("span",{staticStyle:{width:"120px"}},[a("el-input",{attrs:{placeholder:"联系人",size:"mini",clearable:""},model:{value:e.params.contactName,callback:function(t){e.$set(e.params,"contactName",t)},expression:"params.contactName"}})],1),a("span",{staticStyle:{width:"120px"}},[a("el-input",{attrs:{placeholder:"电话",size:"mini",clearable:""},model:{value:e.params.phone,callback:function(t){e.$set(e.params,"phone",t)},expression:"params.phone"}})],1),a("span",{staticStyle:{width:"240px"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",size:"mini"},model:{value:e.params.timeLists,callback:function(t){e.$set(e.params,"timeLists",t)},expression:"params.timeLists"}})],1),a("span",{staticStyle:{width:"120px"}},[a("el-select",{attrs:{placeholder:"请选择付款",size:"mini",clearable:""},model:{value:e.params.isPayed,callback:function(t){e.$set(e.params,"isPayed",t)},expression:"params.isPayed"}},e._l(e.payStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("span",{staticStyle:{width:"120px"}},[a("el-select",{attrs:{placeholder:"请选择发货",size:"small",clearable:""},model:{value:e.params.isShipped,callback:function(t){e.$set(e.params,"isShipped",t)},expression:"params.isShipped"}},e._l(e.shipStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("span",{staticStyle:{width:"120px"}},[a("el-select",{attrs:{placeholder:"请选择开票",size:"small",clearable:""},model:{value:e.params.isInvoice,callback:function(t){e.$set(e.params,"isInvoice",t)},expression:"params.isInvoice"}},e._l(e.invoStatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-button",{attrs:{size:"small"},on:{click:e.getParamData}},[e._v("搜索")])],1)],1),a("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.orderList,"header-cell-style":{background:"#eef1f6",color:"#606266"},stripe:""}},[e._l(e.options.columns,function(e,t){return a("el-table-column",{key:t,attrs:{prop:e.value,label:e.text,width:e.width}})}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"mini",plain:""},on:{click:function(a){return e.handlePrint(t.row.id)}}},[e._v("打印\n              ")]),"未开票"===t.row.isInvoice?a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.handleTicket(t.row.id)}}},[e._v("开票\n              ")]):e._e(),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.handleDelivery(t.row.id)}}},[e._v("发货\n              ")]),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.handleDetail(t.row.id)}}},[e._v("查看\n              ")]),"未付款"===t.row.isPayed&&1===t.row.status?a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.handleCancel(t.row.id)}}},[e._v("取消\n              ")]):e._e()]}}])})],2),a("div",{staticStyle:{"text-align":"center",margin:"20px 0"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:e.total,"page-size":e.params.size},on:{"current-change":e.currentChange}})],1),a("iframe",{staticStyle:{visibility:"hidden"},attrs:{id:"iframe",title:"Inline Frame Example",width:"1200",height:"500"}}),a("el-dialog",{attrs:{title:"发货",visible:e.deliveryDialog,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.deliveryDialog=t}}},[a("el-form",{ref:"deliveryform",attrs:{model:e.deliveryform,rules:e.rules,"label-width":"150px",size:"small"}},[a("el-row",[a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"快递公司：",prop:"expressName"}},[a("el-input",{model:{value:e.deliveryform.expressName,callback:function(t){e.$set(e.deliveryform,"expressName",t)},expression:"deliveryform.expressName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"快递号：",prop:"expressNum"}},[a("el-input",{model:{value:e.deliveryform.expressNum,callback:function(t){e.$set(e.deliveryform,"expressNum",t)},expression:"deliveryform.expressNum"}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveDelivery}},[e._v("确 定")])],1)],1)],1)])],1)},n=[],s=(a("ac6a"),a("fcea3")),r={data:function(){return{orderList:[],total:10,params:{departmen:"",contactName:"",phone:"",timeLists:"",current:1,size:10},deliveryform:{expressName:"",expressNum:""},rules:{},options:{expandAll:!1,columns:[{text:"单位",value:"department",width:120},{text:"联系人",value:"contactName",width:110},{text:"电话",value:"phone",width:140},{text:"创建时间",value:"createTime",width:170},{text:"付款",value:"isPayed",width:100},{text:"发货",value:"isShipped",width:100},{text:"开票",value:"isInvoice",width:100}]},payStatus:[{value:0,label:"未付款"},{value:1,label:"已付款"}],shipStatus:[{value:0,label:"未发货"},{value:1,label:"已发货"}],invoStatus:[{value:0,label:"未开票"},{value:1,label:"已开票"}],tid:"",deliveryDialog:!1}},created:function(){this.getData()},methods:{currentChange:function(e){this.params.current=e,this.getData()},getData:function(){var e=this;Object(s["d"])(this.params).then(function(t){e.orderList=t.data.data.records,e.orderList.forEach(function(t){e.payStatus.forEach(function(e){t.isPayed===e.value&&(t.isPayed=e.label)}),e.shipStatus.forEach(function(e){t.isShipped===e.value&&(t.isShipped=e.label)}),e.invoStatus.forEach(function(e){t.isInvoice===e.value&&(t.isInvoice=e.label)})})})},handleAdd:function(){this.$router.push({path:"/textbook_spa/order_detail"})},handlePrint:function(e){var t=window.location.origin,a="".concat(t,"/print_order/").concat(e),i=window.document.getElementById("iframe");i.src=a,i.onload=function(){i.contentWindow.focus(),i.contentWindow.print()}},handleDetail:function(e){this.$router.push({path:"/textbook_spa/order_detail",query:{see:e}})},handleTicket:function(e){var t=this;this.$confirm("请确定该订单已开票，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s["f"])({id:e}).then(function(){t.$message.success("开票成功！"),t.getData()}).catch(function(){t.$message.error("开票失败！")})}).catch(function(){t.$message({type:"info",message:"已取消此操作！"})})},handleDelivery:function(e){this.tid=e,this.deliveryform={expressName:"",expressNum:""},this.deliveryDialog=!0},handleClose:function(){this.deliveryDialog=!1},saveDelivery:function(){var e=this,t={id:this.tid,expressName:this.deliveryform.expressName,expressNum:this.deliveryform.expressNum};Object(s["b"])(t).then(function(){e.$message.success("提交成功！"),e.getData(),e.deliveryDialog=!1}).catch(function(){e.$message.error("提交失败！")})},handleCancel:function(e){var t=this;this.$confirm("此操作将取消该教材订单，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s["a"])(e).then(function(){t.$message.success("取消成功！"),t.getData()}).catch(function(){t.$message.error("取消失败！")})}).catch(function(){t.$message({type:"info",message:"已取消此操作！"})})},getParamData:function(){this.params.timeLists&&(this.params.startDate=this.params.timeLists[0],this.params.endDate=this.params.timeLists[1]),this.params.current=1,this.getData()}}},l=r,o=(a("b73a"),a("0c7c")),c=Object(o["a"])(l,i,n,!1,null,"37564caa",null);t["default"]=c.exports},b73a:function(e,t,a){"use strict";var i=a("b9ac"),n=a.n(i);n.a},b9ac:function(e,t,a){},fcea3:function(e,t,a){"use strict";a.d(t,"e",function(){return s}),a.d(t,"d",function(){return r}),a.d(t,"c",function(){return l}),a.d(t,"a",function(){return o}),a.d(t,"f",function(){return c}),a.d(t,"b",function(){return u});var i=a("b5c6"),n="/tybhrms/tybbookorder";function s(e){return Object(i["a"])({url:"".concat(n,"/save"),method:"post",data:e})}function r(e){return Object(i["a"])({url:"".concat(n,"/page"),method:"get",params:e})}function l(e){return Object(i["a"])({url:"".concat(n,"/").concat(e),method:"get"})}function o(e){return Object(i["a"])({url:"".concat(n,"/cancel/").concat(e),method:"post"})}function c(e){return Object(i["a"])({url:"".concat(n,"/ticket"),method:"get",params:e})}function u(e){return Object(i["a"])({url:"".concat(n,"/delivery"),method:"get",params:e})}}}]);