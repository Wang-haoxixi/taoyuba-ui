(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a7c0c94c"],{"02b1":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("iep-dialog",{attrs:{"dialog-show":t.dialogShow,title:"预览纪要",width:"80%"},on:{close:t.resetForm}},[a("detail-form",{ref:"detail",attrs:{detailState:!0},on:{backPage:t.resetForm}})],1)},o=[],i=a("0095"),n=a("38b4"),s={components:{DetailForm:i["default"]},data:function(){return{dialogShow:!1,formData:Object(n["d"])()}},methods:{open:function(t){var e=this;this.dialogShow=!0,this.$nextTick(function(){e.formData.host=e.formData.hostList,e.$refs["detail"].handleDealData(Object.assign({},e.formData,t),!0)})},resetForm:function(){this.dialogShow=!1}}},c=s,l=a("0c7c"),u=Object(l["a"])(c,r,o,!1,null,null,null);e["default"]=u.exports},"0a22":function(t,e,a){"use strict";a.d(e,"f",function(){return n}),a.d(e,"e",function(){return s}),a.d(e,"a",function(){return c}),a.d(e,"g",function(){return l}),a.d(e,"d",function(){return u}),a.d(e,"b",function(){return m}),a.d(e,"c",function(){return f});var r=a("7618"),o=a("b5c6"),i="/prms/iepProjectInformation";function n(t){return Object(o["a"])({url:"".concat(i,"/page"),method:"get",params:t})}function s(t){return Object(o["a"])({url:"".concat(i,"/page"),method:"get",params:t})}function c(t){return Object(o["a"])({url:"".concat(i),method:"post",data:t})}function l(t){return Object(o["a"])({url:"".concat(i,"/edit"),method:"post",data:t})}function u(t){return Object(o["a"])({url:"".concat(i,"/").concat(t),method:"get"})}function m(t){var e="object"===Object(r["a"])(t)?t:[t];return Object(o["a"])({url:"".concat(i,"/delete/batch"),method:"post",data:e})}function f(t){return Object(o["a"])({url:"".concat(i,"/projectApproval"),method:"get",params:t})}},1509:function(t,e,a){"use strict";var r=a("8018"),o=a.n(r);o.a},"4e02":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("iep-dialog",{attrs:{"dialog-show":t.dialogShow,title:"选择项目",width:"40%"},on:{close:function(e){return t.resetForm("form")}}},[a("div",{staticClass:"search"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:t.params.projectName,callback:function(e){t.$set(t.params,"projectName",e)},expression:"params.projectName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.searchProject},slot:"append"})],1)],1),a("div",{staticClass:"scroll",staticStyle:{height:"300px"}},[a("iep-scroll",{attrs:{load:t.projectState},on:{"load-page":t.loadProject}},[a("div",{staticClass:"form"},[a("div",{staticClass:"select-content"},[a("div",{staticClass:"title"},[t._v("请从列表中选择项目")]),a("div",{staticClass:"select-ul"},[a("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.list,function(e,r){return a("div",{key:r,staticClass:"select-li"},[a("el-checkbox",{attrs:{label:e,checked:t.isChecked(e.id)}},[t._v(t._s(e.projectName))])],1)}),0)],1)])])])],1),a("template",{slot:"footer"},[a("iep-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v(t._s(t.methodName))]),a("iep-button",{on:{click:function(e){return t.resetForm("form")}}},[t._v("取消")])],1)],2)},o=[],i=(a("ac4d"),a("8a81"),a("ac6a"),a("720d")),n=a("0a22"),s={components:{IepScroll:i["default"]},data:function(){return{dialogShow:!1,formRequestFn:function(){},methodName:"确定",list:[],projectState:0,params:{current:1,size:10,projectName:""},checkList:[],isCheckList:[]}},methods:{open:function(t){this.dialogShow=!0,this.checkList=[],this.isCheckList=t,this.list=[],this.params={current:1,size:10,projectName:""},this.loadProject()},loadPage:function(){this.$emit("load-page")},resetForm:function(){this.dialogShow=!1},submitForm:function(){0!=this.checkList.length?(this.$emit("selectProject",this.checkList),this.resetForm()):this.$message.error("请至少选择一个项目")},loadProject:function(){var t=this;Object(n["f"])(this.params).then(function(e){var a=e.data,r=a.data.records;r.length>0?(t.params.current++,t.projectState=0,t.list=t.list.concat(r)):t.projectState=7})},searchProject:function(){this.projectState=4,this.list=[],this.params.current=1,this.loadProject()},isChecked:function(t){var e=!0,a=!1,r=void 0;try{for(var o,i=this.isCheckList[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var n=o.value;if(n.id==t)return!0}}catch(s){a=!0,r=s}finally{try{e||null==i.return||i.return()}finally{if(a)throw r}}return!1}}},c=s,l=(a("d18a"),a("0c7c")),u=Object(l["a"])(c,r,o,!1,null,"c16507e0",null);e["default"]=u.exports},"720d":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"myScroll",staticClass:"iep-scroll",on:{"&scroll":function(e){return t.onScroll(e)}}},[t._t("default"),a("div",{staticClass:"footer"},[t._v(t._s(t.stateList[t.state]))])],2)},o=[],i=(a("c5f6"),{props:{loadData:{type:Function},load:{type:Number,default:0}},data:function(){return{myScroll:null,myScrollList:null,state:0,stateList:{0:"",1:"刷新中",2:"松开刷新",3:"刷新完成",4:"加载中",5:"加载完成",6:"下拉刷新",7:"暂无更多数据"}}},methods:{onScroll:function(t){var e=this.myScrollList.offsetHeight,a=t.target.scrollTop+this.myScroll.offsetHeight;0==this.state&&e-a<100&&this.bottomCallback()},bottomCallback:function(){7!=this.state&&(this.state=4,this.$emit("load-page",!0))}},watch:{load:function(t){this.state=t}},mounted:function(){this.myScroll=this.$refs.myScroll,this.myScrollList=this.myScroll.children[0]}}),n=i,s=(a("92aa"),a("0c7c")),c=Object(s["a"])(n,r,o,!1,null,null,null);e["default"]=c.exports},8018:function(t,e,a){},"92aa":function(t,e,a){"use strict";var r=a("b278"),o=a.n(r);o.a},a6e9:function(t,e,a){"use strict";a.d(e,"f",function(){return s}),a.d(e,"e",function(){return c}),a.d(e,"i",function(){return l}),a.d(e,"j",function(){return u}),a.d(e,"d",function(){return m}),a.d(e,"a",function(){return f}),a.d(e,"b",function(){return d}),a.d(e,"c",function(){return p}),a.d(e,"g",function(){return h}),a.d(e,"h",function(){return v});var r=a("b5c6"),o=a("4328"),i=a.n(o),n="/crm/customer";function s(t){return Object(r["a"])({url:"".concat(n,"/page"),method:"get",params:t,paramsSerializer:function(t){return i.a.stringify(t,{indices:!1})}})}function c(t){return Object(r["a"])({url:"".concat(n,"/").concat(t),method:"get"})}function l(t){return Object(r["a"])({url:"".concat(n,"/create"),method:"post",data:t})}function u(t){return Object(r["a"])({url:"".concat(n,"/update"),method:"post",data:t})}function m(t){return Object(r["a"])({url:"".concat(n,"/delete/batch"),method:"post",data:t})}function f(t){return Object(r["a"])({url:"".concat(n,"/create/collaboration"),method:"post",data:t})}function d(t){return Object(r["a"])({url:"".concat(n,"/transfer"),method:"post",data:t})}function p(t){return Object(r["a"])({url:"".concat(n,"/nameExists"),method:"get",params:t})}function h(t){return Object(r["a"])({url:"".concat(n,"/clientMarket"),method:"get",params:t})}function v(t){return Object(r["a"])({url:"".concat(n,"/myorcoll/list"),method:"get",params:t})}},ac33:function(t,e,a){},b278:function(t,e,a){},d18a:function(t,e,a){"use strict";var r=a("ac33"),o=a.n(r);o.a},d986:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"iep-page-form"},[a("basic-container",[a("page-header",{attrs:{title:t.methodName+"纪要",backOption:t.backOption}}),a("el-form",{ref:"form",staticStyle:{"margin-bottom":"50px"},attrs:{model:t.formData,rules:t.rules,size:"small","label-width":"130px"}},[a("el-form-item",{attrs:{label:"会议类型：",prop:"meetingType"}},[a("el-radio-group",{model:{value:t.formData.meetingType,callback:function(e){t.$set(t.formData,"meetingType",e)},expression:"formData.meetingType"}},t._l(t.dictGroup.mlms_meeting_type,function(e,r){return a("el-radio",{key:r,attrs:{label:e.value},on:{change:t.typeChange}},[t._v("\n              "+t._s(e.label)+"\n              "),a("iep-tip",{attrs:{content:t.tipContent.meetingType[e.value]}})],1)}),1)],1),1==t.formData.type?a("el-form-item",{attrs:{label:"拜访对象：",prop:"visitingUserId"}},[a("IepCrmsSelectMultiple",{attrs:{option:t.formData.visitingUser,prefixUrl:"crm/customer/all/list"},model:{value:t.formData.visitingUserId,callback:function(e){t.$set(t.formData,"visitingUserId",e)},expression:"formData.visitingUserId"}})],1):t._e(),a("el-form-item",{attrs:{label:(0==t.formData.type?"会议主题 ":"会议标题")+"：",prop:"title"}},[a("el-input",{attrs:{maxlength:"50",placeholder:t.tipContent.title},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),a("el-form-item",{attrs:{label:"会议内容：",prop:"meetingContent"}},[a("iep-froala-editor",{attrs:{placeholder:t.tipContent.meetingContent},model:{value:t.formData.meetingContent,callback:function(e){t.$set(t.formData,"meetingContent",e)},expression:"formData.meetingContent"}})],1),a("el-form-item",{attrs:{label:"会议总结：",prop:"meetingCon"}},[a("el-input",{attrs:{type:"textarea",rows:"8",maxlength:"1000",placeholder:"一、简明扼要说明会议精神，如1、2、3......\n二、清晰罗列下一步工作计划，如1、2、3......（关联人员需要着重说明）"},model:{value:t.formData.meetingCon,callback:function(e){t.$set(t.formData,"meetingCon",e)},expression:"formData.meetingCon"}})],1),a("el-form-item",{attrs:{label:"感想与困惑：",prop:"thoughtsProblem"}},[a("el-input",{attrs:{type:"textarea",rows:"5",maxlength:"1000",placeholder:"1、分段发表感想和说明困惑之处，如1、2、3......\n2、感想主要围绕会议中所汇报内容和指导意见如何应用到之后工作中；\n3、困惑主要围绕目前工作中疑惑不解，需要寻求帮助的事情。"},model:{value:t.formData.thoughtsProblem,callback:function(e){t.$set(t.formData,"thoughtsProblem",e)},expression:"formData.thoughtsProblem"}})],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"会议时间",prop:"meetingTime"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n                会议时间\n                "),a("iep-tip",{attrs:{content:t.tipContent.meetingTime}}),t._v("：\n              ")],1),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},model:{value:t.formData.meetingTime,callback:function(e){t.$set(t.formData,"meetingTime",e)},expression:"formData.meetingTime"}})],1)],1),0==t.formData.type?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"会议地点：",prop:"meetingLocation"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n                会议地点\n                "),a("iep-tip",{attrs:{content:t.tipContent.meetingLocation}}),t._v("：\n              ")],1),a("el-input",{attrs:{maxlength:"50"},model:{value:t.formData.meetingLocation,callback:function(e){t.$set(t.formData,"meetingLocation",e)},expression:"formData.meetingLocation"}})],1)],1):t._e()],1),1==t.formData.type?a("el-form-item",{attrs:{label:"拜访形式：",prop:"visitType"}},[a("el-radio-group",{model:{value:t.formData.visitType,callback:function(e){t.$set(t.formData,"visitType",e)},expression:"formData.visitType"}},t._l(t.dictGroup.mlms_visit_type,function(e,r){return a("el-radio",{key:r,attrs:{label:""+e.value}},[t._v(t._s(e.label))])}),1)],1):t._e(),"1"==t.formData.visitType&&1==t.formData.type?a("el-form-item",{attrs:{label:"",prop:"visitingAddress"}},[a("el-input",{attrs:{placeholder:"请输入面访具体地址"},model:{value:t.formData.visitingAddress,callback:function(e){t.$set(t.formData,"visitingAddress",e)},expression:"formData.visitingAddress"}})],1):t._e(),a("el-form-item",{attrs:{label:"会议标签：",prop:"tagKeyWords"}},[a("iep-tag",{model:{value:t.formData.tagKeyWords,callback:function(e){t.$set(t.formData,"tagKeyWords",e)},expression:"formData.tagKeyWords"}}),a("div",{staticStyle:{"font-size":"12px",color:"#aaa"}},[t._v(t._s(t.tipContent.tagKeyWords))])],1),a("el-form-item",{attrs:{label:"主持人：",prop:"hostList"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n            主持人\n            "),a("iep-tip",{attrs:{content:t.tipContent.hostList}}),t._v("：\n          ")],1),a("div",{staticStyle:{width:"200px"}},[a("iep-contact-select",{model:{value:t.formData.hostList,callback:function(e){t.$set(t.formData,"hostList",e)},expression:"formData.hostList"}})],1)]),a("el-form-item",{attrs:{label:"参会人：",prop:"attendeeList"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n            参会人\n            "),a("iep-tip",{attrs:{content:t.tipContent.attendeeList}}),t._v("：\n          ")],1),a("iep-contact-multiple",{attrs:{filterUserList:t.attendeeUserList},model:{value:t.formData.attendeeList,callback:function(e){t.$set(t.formData,"attendeeList",e)},expression:"formData.attendeeList"}})],1),a("el-form-item",{attrs:{label:"抄送人：",prop:"receiverList"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n            抄送人\n            "),a("iep-tip",{attrs:{content:t.tipContent.receiverList}}),t._v("：\n          ")],1),a("iep-contact-multiple",{attrs:{filterUserList:t.receiverUserList},model:{value:t.formData.receiverList,callback:function(e){t.$set(t.formData,"receiverList",e)},expression:"formData.receiverList"}})],1),a("el-form-item",{attrs:{label:"关联项目：",prop:"projectList"}},[t._l(t.formData.projectList,function(e,r){return a("el-tag",{key:r,attrs:{type:"info"}},[t._v(t._s(e.name))])}),a("iep-button",{on:{click:t.selectProject}},[a("i",{staticClass:"el-icon-plus"})])],2)],1),a("footer-tool-bar",[a("iep-button",{attrs:{type:"primary"},on:{click:t.handlePreview}},[t._v("预览")]),1==t.formData.status||"创建"==t.methodName?a("iep-button",{attrs:{type:"primary",loading:t.loadState},on:{click:function(e){return t.saveDraft("form")}}},[t._v("保存草稿")]):t._e(),a("iep-button",{attrs:{type:"primary",loading:t.loadState},on:{click:function(e){return t.saveForm("form")}}},[t._v(t._s(0==t.formData.isSend?"保存":"保存并发送"))]),a("iep-button",{on:{click:function(e){return t.resetForm("form")}}},[t._v("取消")])],1)],1),a("projectDialog",{ref:"project",on:{selectProject:t.submitProject}}),a("previewDialog",{ref:"preview"})],1)},o=[],i=(a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("cebc")),n=a("38b4"),s=a("2f62"),c=a("a6e9"),l=a("6837"),u=a("4e02"),m=a("02b1"),f={components:{projectDialog:u["default"],previewDialog:m["default"]},data:function(){var t=this;return{loadState:!1,dictsMap:n["b"],tipContent:n["i"],formRequestFn:l["d"],methodName:"创建",methodType:"create",formData:Object(n["d"])(),rules:n["g"],clientList:[],backOption:{isBack:!0,backPath:null,backFunction:function(){t.goBack()}},backRouter:"/wel/material/summary",pageState:"summary"}},computed:Object(i["a"])({},Object(s["c"])(["dictGroup"]),{attendeeUserList:function(){var t=[];this.formData.hostList.id&&t.push(this.formData.hostList.id);var e=!0,a=!1,r=void 0;try{for(var o,i=this.formData.receiverList.orgs[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var n=o.value;t.push(n.id)}}catch(d){a=!0,r=d}finally{try{e||null==i.return||i.return()}finally{if(a)throw r}}var s=!0,c=!1,l=void 0;try{for(var u,m=this.formData.receiverList.users[Symbol.iterator]();!(s=(u=m.next()).done);s=!0){var f=u.value;t.push(f.id)}}catch(d){c=!0,l=d}finally{try{s||null==m.return||m.return()}finally{if(c)throw l}}return t},receiverUserList:function(){var t=[];this.formData.hostList.id&&t.push(this.formData.hostList.id);var e=!0,a=!1,r=void 0;try{for(var o,i=this.formData.attendeeList.orgs[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var n=o.value;t.push(n.id)}}catch(d){a=!0,r=d}finally{try{e||null==i.return||i.return()}finally{if(a)throw r}}var s=!0,c=!1,l=void 0;try{for(var u,m=this.formData.attendeeList.users[Symbol.iterator]();!(s=(u=m.next()).done);s=!0){var f=u.value;t.push(f.id)}}catch(d){c=!0,l=d}finally{try{s||null==m.return||m.return()}finally{if(c)throw l}}return t}}),methods:{saveForm:function(t){var e=this;delete this.formData.createTime,delete this.formData.updateTime,this.$refs[t].validate(function(t){if(!t)return!1;e.formData.status=0,e.submitForm()})},saveDraft:function(){""!=this.formData.title?(this.formData.status=1,this.submitForm()):this.$message.error("请至少填写会议的标题！")},submitForm:function(){var t=this;this.loadState=!0,this.formData.hostId=this.formData.hostList.id,this.formData.attendee={orgIds:this.formData.attendeeList.orgs.map(function(t){return t.id}),userIds:this.formData.attendeeList.users.map(function(t){return t.id})},this.formData.receiver={orgIds:this.formData.receiverList.orgs.map(function(t){return t.id}),userIds:this.formData.receiverList.users.map(function(t){return t.id})},this.formData.projectList.length>0?this.formData.projectIds=this.formData.projectList.map(function(t){return t.id}):this.formData.projectIds=[],this.formRequestFn(this.formData).then(function(e){var a=e.data,r="create"==t.methodType?a.data:t.formData.id;t.loadState=!1,0==t.formData.status&&1==t.formData.isSend?Object(l["l"])(r).then(function(e){var a=e.data;a.data?(t.$message.success("您成功发送一篇会议纪要，继续加油！"),t.goBack(!0)):t.$message.error("当前网络异常，请稍后再试！")}):(t.$message({message:"".concat(t.methodName,"成功"),type:"success"}),t.goBack(!0))})},resetForm:function(){this.goBack()},typeChange:function(t){var e=6==t?1:0;this.$set(this.formData,"type",e)},goBack:function(t){"summary"==this.pageState?this.$router.go(-1):"project"==this.pageState&&this.$emit("close",!0===t)},selectProject:function(){this.$refs["project"].open(this.formData.projectList)},submitProject:function(t){var e=function(t){return{id:t.id,name:t.projectName}};this.formData.projectList=t.map(e)},projectOpen:function(t){this.formData=Object(n["d"])(),this.formData.projectList=[t],this.pageState="project"},handlePreview:function(){this.$refs["preview"].open(this.formData)}},created:function(){var t=this,e=this.$route.params;e.id&&"修改纪要"==this.$route.name&&(this.methodType="update",Object(l["g"])(e.id).then(function(e){var a=e.data;a.data.receiverList={orgs:a.data.receiver.orgs?a.data.receiver.orgs:[],users:a.data.receiver.users?a.data.receiver.users:[],unions:[]},a.data.attendeeList={orgs:a.data.attendee.orgs?a.data.attendee.orgs:[],users:a.data.attendee.users?a.data.attendee.users:[],unions:[]},a.data.hostList=a.data.host.length>0?a.data.host[0]:{id:"",name:""},t.formData=Object(i["a"])({},a.data),t.methodName="修改",t.formRequestFn=l["m"]})),Object(c["f"])({type:1}).then(function(e){var a=e.data;t.clientList=a.data.records})}},d=f,p=(a("1509"),a("0c7c")),h=Object(p["a"])(d,r,o,!1,null,"5609b864",null);e["default"]=h.exports}}]);